{"version":3,"sources":["functions/firebase.ts","components/UnstyledLink.tsx","pages/ReceiptsPage.tsx","functions/utils.ts","hooks/useLocalStorage.tsx","hooks/useAppData.tsx","components/EditableField.tsx","pages/old/ItemsTab.tsx","pages/old/PeopleTab.tsx","components/DebugView.tsx","pages/old/OldApp.tsx","pages/ReceiptItemsTab.tsx","pages/ReceiptPeopleTab.tsx","pages/ReceiptInfoPage.tsx","core/BaseRouter.tsx","core/Layout.tsx","core/App.tsx","index.tsx"],"names":["firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","auth","receiptsRef","database","ref","child","useGetReceipt","id","useState","isLoading","setIsLoading","receipt","setReceipt","useEffect","on","snapshot","val","items","useMemo","Object","entries","map","item","subTotal","reduce","sum","currency","add","cost","value","people","person","setPersonItemQuantity","personId","itemId","a","quantity","update","Math","max","personSubTotalMap","personToItemQuantityMap","total","tipCost","taxCost","getChargeForPerson","charge","divide","multiply","getTotalForPerson","updateChargeValue","receiptId","valueString","set","updateChargeValueByPct","percentString","parseFloat","updateReceiptItemValue","key","UnstyledLink","children","style","otherProps","color","textDecoration","ReceiptsPage","receipts","data","setData","newState","push","useGetReceipts","Container","maxWidth","sx","pt","display","flexDirection","gap","Typography","mb","Paper","width","List","to","Routes","receiptInfo","route","ListItem","button","flex","title","format","Date","date","NewReceiptForm","setTitle","onSubmit","event","preventDefault","getTime","itemToPersonQuantityMap","Box","TextField","label","fullWidth","variant","onChange","target","Button","type","nameToInitials","name","toUpperCase","split","part","substr","join","setify","array","Set","useLocalStorage","initialValue","window","localStorage","getItem","JSON","parse","error","console","log","storedValue","setStoredValue","valueToStore","Function","setItem","stringify","appDataDefaults","personToItemsMap","itemToPeopleMap","tip","tax","noop","AppDataContext","createContext","appData","setAppData","reset","putItem","removeItem","splitItem","putPerson","removePerson","handleSetItemPerson","itemCostMap","subTotalForPerson","taxForPerson","tipForPerson","totalForPerson","AppDataContextProvider","curr","previousValue","currentValue","length","percentForPerson","Provider","newItem","prev","index","indexOf","filter","find","splitCount","parseInt","prompt","isNaN","newItems","Array","fill","_","uuidv4","newPerson","personIds","selected","_itemId","_personId","useAppData","useContext","EditableField","formatValue","disabled","textAlign","isEditMode","setIsEditMode","textFieldRef","useRef","theme","useTheme","tempValue","setTempValue","useLayoutEffect","current","focus","containerProps","paddingTop","paddingBottom","DisplayTextField","align","Underline","marginTop","height","backgroundColor","palette","text","opacity","onBlur","onFocus","setTimeout","setSelectionRange","onKeyDown","includes","code","inputRef","inputProps","ButtonBase","onClick","itemEntryFormDefaults","undefined","StyledTable","styled","Table","whiteSpace","ItemsTab","resetAll","useForm","defaultValues","control","handleSubmit","nameFieldRef","costFieldRef","handleOnSubmit","handleOnKeyDown","confirm","Grid","container","spacing","xs","alignItems","md","render","field","rules","required","overflow","position","TableHead","TableRow","TableCell","left","zIndex","minWidth","Tooltip","Avatar","fontSize","TableBody","amber","String","IconButton","size","edge","marginRight","Checkbox","checked","taxPct","toFixed","tipPct","location","href","txn","user","amount","note","getVenmoPaymentLink","PeopleTab","personNameInput","setPersonNameInput","handleAddPerson","trim","ListItemAvatar","ListItemSecondaryAction","DebugView","showDebugView","setShowDebugView","marginBottom","Card","Collapse","in","CardContent","buttonTitle","UncontrolledCollapse","open","setOpen","App","currentTab","setCurrentTab","Tabs","indicatorColor","textColor","centered","Tab","warningBgColor","ReceiptItemsTab","useParams","ItemsTable","useCallback","remove","TableContainer","component","justifyContent","colSpan","isItemFull","values","getPersonCountForItem","personItemQuantity","getItemQuantityForPerson","percent","addItemFormDefaults","addItemFormValidation","yup","shape","positive","integer","AddItemForm","resolver","yupResolver","quantityFieldRef","form","handleFocus","p","sm","step","min","ReceiptPeopleTab","Divider","mt","ReceiptInfoPage","tab","history","useHistory","CircularProgress","ReceiptInfoTabs","updateReceiptValue","path","tabPath","exact","from","RECEIPTS_PATH","RECEIPT_INFO_PATH","params","generatePath","replace","BaseRouter","OldApp","Offset","mixins","toolbar","Layout","AppBar","Toolbar","flexGrow","createTheme","background","default","grey","ThemeProvider","CssBaseline","ReactDOM","StrictMode","document","getElementById"],"mappings":"mTAgBAA,IAASC,cAVM,CACbC,OAAQ,0CACRC,WAAY,6BACZC,UAAW,aACXC,cAAe,yBACfC,kBAAmB,eACnBC,MAAO,4CACPC,cAAe,iBAIGR,IAASS,KAAtB,IAEMC,EADcV,IAASW,WAAWC,MACRC,MAAM,YA8DhCC,EAAgB,SAACC,GAAuC,IAAD,EAChCC,oBAAS,GADuB,mBAC3DC,EAD2D,KAChDC,EADgD,OAEpCF,qBAFoC,mBAE3DG,EAF2D,KAElDC,EAFkD,KAIlEC,qBAAU,WACRX,EAAYG,MAAME,GAAIO,GAAG,SAAS,SAACC,GACjC,IAAMJ,EAAUI,EAASC,MACzBJ,EAAW,2BAAKD,GAAN,IAAeJ,QACzBG,GAAa,QAEd,IAEH,IAAMO,EAAQC,mBAA2B,WAAO,IAAD,EAC7C,OAAKP,EACEQ,OAAOC,QAAP,UAAeT,EAAQM,aAAvB,QAAgC,IAAII,KAAI,mCAAEd,EAAF,KAAMe,EAAN,wBAAC,eAAqBA,GAAtB,IAA4Bf,UADtD,KAEpB,CAACI,IAEEY,EAAWL,mBAAQ,kBAAMD,EAAMO,QAAO,SAACC,EAAKH,GAAN,OAAeI,IAASD,GAAKE,IAAIL,EAAKM,MAAMC,QAAO,KAAI,CAACZ,IAE9Fa,EAASZ,mBAA6B,WAAO,IAAD,EAChD,OAAKP,EACEQ,OAAOC,QAAP,UAAeT,EAAQmB,cAAvB,QAAiC,IAAIT,KAAI,mCAAEd,EAAF,KAAMwB,EAAN,wBAAC,eAAuBA,GAAxB,IAAgCxB,UAD3D,KAEpB,CAACI,IAEEqB,EAAqB,uCAAG,WAAOC,EAAkBC,GAAzB,2BAAAC,EAAA,6DAAyCC,EAAzC,+BAAoD,EAApD,SACtBlC,EACHG,MAAME,GACNF,MAAM,2BACNA,MAAM4B,GACN5B,MAAM6B,GACNG,OAAO,CAAED,SAAUE,KAAKC,IAAIH,EAAU,KANb,uBAOtBlC,EACHG,MAAME,GACNF,MAAM,2BACNA,MAAM6B,GACN7B,MAAM4B,GACNI,OAAO,CAAED,SAAUE,KAAKC,IAAIH,EAAU,KAZb,2CAAH,wDAerBI,EAAoBtB,mBAAgC,WACxD,IAAMsB,EAA4C,GAClD,GAAI7B,EAAS,CAAC,IAAD,gBACUmB,GADV,IACX,2BAA6B,CAAC,IAAD,IAAlBC,EAAkB,QAC3BS,EAAkBT,EAAOxB,IAAMY,OAAOC,QAAP,oBAAeT,EAAQ8B,+BAAvB,aAAe,EAAkCV,EAAOxB,WAAxD,QAA+D,IAAIiB,QAChG,SAACC,EAAD,gCAAOS,EAAP,YAAiCT,EAAjC,KAAiBW,UAA8B,oBAAIzB,EAAQM,aAAZ,iBAAI,EAAgBiB,UAApB,aAAI,EAAyBN,YAA7B,QAAqC,KACpF,IAJO,+BAQb,OAAOY,IACN,CAAC7B,IAEE+B,EAAQxB,mBAAQ,0BAAMK,GAAQ,iBAAIZ,QAAJ,IAAIA,OAAJ,EAAIA,EAASgC,eAAb,QAAwB,IAAhC,iBAAsChC,QAAtC,IAAsCA,OAAtC,EAAsCA,EAASiC,eAA/C,QAA0D,KAAI,CAACrB,EAAUZ,IAE/FkC,EAAqB,SAACC,EAAoBb,GAArB,aACzBP,IAASc,EAAkBP,IACxBc,OAAOxB,EAAW,EAAIA,EAAW,GACjCyB,SAFH,iBAEYrC,QAFZ,IAEYA,OAFZ,EAEYA,EAAUmC,UAFtB,QAEiC,GAAGjB,OAOtC,MAAO,CACLpB,YACAE,UACAM,QACAM,WACAmB,QACAZ,SACAE,wBACAQ,oBACAK,qBACAI,kBAfwB,SAAChB,GAAD,OACxBP,IAASc,EAAkBP,IACxBN,IAAIkB,EAAmB,UAAWZ,IAClCN,IAAIkB,EAAmB,UAAWZ,IAAWJ,SA6BvCqB,EAAoB,SAACC,EAAmBL,EAAoBM,GAAxC,OAC/BlD,EAAYG,MAAM8C,GAAW9C,MAAMyC,GAAQO,IAAI3B,IAAS0B,GAAavB,QAE1DyB,EAAyB,SACpCH,EACAL,EACAS,EACAhC,GAEA,IAAMM,EAAQH,IAASH,GAAUyB,SAASQ,WAAWD,IAAgBR,OAAO,KAAOlB,MACnF,OAAO3B,EAAYG,MAAM8C,GAAW9C,MAAMyC,GAAQO,IAAI3B,IAASG,GAAOA,QAW3D4B,EAAyB,SACpCN,EACAjB,EACAwB,EACA7B,GAEA,OAAO3B,EAAYG,MAAM8C,GAAW9C,MAAM,SAASA,MAAM6B,GAAQ7B,MAAMqD,GAAKL,IAAIxB,I,iCC9LnE8B,EAN+C,SAAC,GAAD,IAAGC,EAAH,EAAGA,SAAUC,EAAb,EAAaA,MAAUC,EAAvB,2CAC5D,cAAC,IAAD,yBAAMD,MAAK,aAAIE,MAAO,UAAWC,eAAgB,WAAcH,IAAaC,GAA5E,aACGF,MCGQK,EAAkC,WAC7C,IAAMC,EFqCsB,WAA6B,IAAD,EAChC1D,mBAA+B,IADC,mBACjD2D,EADiD,KAC3CC,EAD2C,KAiBxD,OAdAvD,qBAAU,WACRX,EAAYY,GAAG,SAAS,SAACC,GACvB,IAAME,EAAQF,EAASC,MACjBqD,EAAW,GACjB,IAAK,IAAM/C,KAAQL,EACjBoD,EAASC,KAAT,aACE/D,GAAIe,GACDL,EAAMK,KAGb8C,EAAQC,QAET,IAEIF,EEtDUI,GAEjB,OACE,eAACC,EAAA,EAAD,CAAWC,SAAU,KAAMC,GAAI,CAAEC,GAAI,EAAGC,QAAS,OAAQC,cAAe,SAAUC,IAAK,GAAvF,UACE,cAACC,EAAA,EAAD,CAAYL,GAAI,CAAEM,GAAI,GAAtB,sBACA,cAACC,EAAA,EAAD,CAAOP,GAAI,CAAEQ,MAAO,QAApB,SACE,cAACC,EAAA,EAAD,UACGjB,EAAS7C,KAAI,SAACV,GAAD,OACZ,cAAC,EAAD,CAA+ByE,GAAIC,GAAOC,YAAYC,MAAM,CAAEpC,UAAWxC,EAAQJ,KAAjF,SACE,cAACiF,EAAA,EAAD,CAAUC,QAAM,EAAC5B,MAAO,CAAEqB,MAAO,QAAjC,SACE,sBAAKrB,MAAO,CAAEqB,MAAO,OAAQN,QAAS,OAAQC,cAAe,SAAUC,IAAK,IAA5E,UACE,sBAAKjB,MAAO,CAAEe,QAAS,QAAvB,UACE,cAACG,EAAA,EAAD,CAAYlB,MAAO,CAAE6B,KAAM,GAA3B,SAAiC/E,EAAQgF,QACzC,cAACZ,EAAA,EAAD,UAAarD,IAASf,EAAQ+B,OAAOkD,cAEvC,cAACb,EAAA,EAAD,UAAaa,YAAO,IAAIC,KAAKlF,EAAQmF,MAAO,cAP/BnF,EAAQJ,WAcjC,cAAC,EAAD,QAKAwF,EAAiB,WAAO,IAAD,EACDvF,mBAAS,IADR,mBACpBmF,EADoB,KACbK,EADa,KAY3B,OACE,sBAAMC,SAVS,SAACC,GFwHO,IAACvF,GEvHxBuF,EAAMC,iBAEDR,MFqHmBhF,EEnHZ,CAAEgF,UFoHHG,OAAMnF,EAAQmF,MAAO,IAAID,MAAOO,WACxCzF,EAAQ+B,QAAO/B,EAAQ+B,MAAQ,GAC/B/B,EAAQiC,UAASjC,EAAQiC,QAAU,GACnCjC,EAAQgC,UAAShC,EAAQgC,QAAU,GACnChC,EAAQM,QAAON,EAAQM,MAAQ,IAC/BN,EAAQmB,SAAQnB,EAAQmB,OAAS,IACjCnB,EAAQ8B,0BAAyB9B,EAAQ8B,wBAA0B,IACnE9B,EAAQ0F,0BAAyB1F,EAAQ0F,wBAA0B,IAEjEnG,EAAYoE,KAAK3D,GE5HtBqF,EAAS,MAIT,SACE,eAACM,EAAA,EAAD,CAAK5B,GAAI,CAAEE,QAAS,QAApB,UACE,cAAC2B,EAAA,EAAD,CACEC,MAAO,eACP3E,MAAO8D,EACPc,WAAS,EACTC,QAAS,WACTC,SAAU,SAACT,GAAD,OAAWF,EAASE,EAAMU,OAAO/E,QAC3C6C,GAAI,CAAEgB,KAAM,KAEd,cAACmB,EAAA,EAAD,CAAQC,KAAM,SAAd,uB,oJC3DKC,GAAiB,SAACC,GAC7B,OAAOA,EACJC,cACAC,MAAM,KACN7F,KAAI,SAAC8F,GAAD,OAAUA,EAAKC,OAAO,EAAG,MAC7BC,KAAK,KAKGC,GAAS,SAAIC,GAAJ,mBAA4B,IAAIC,IAAID,K,QC2B3CE,OAnCf,SAA4B/D,EAAagE,GAAmD,MAGpDlH,oBAAY,WAChD,IAEE,IAAMc,EAAOqG,OAAOC,aAAaC,QAAQnE,GAEzC,OAAOpC,EAAOwG,KAAKC,MAAMzG,GAAQoG,EACjC,MAAOM,GAIP,OADAC,QAAQC,IAAIF,GACLN,MAb+E,mBAGnFS,EAHmF,KAGtEC,EAHsE,KAgC1F,MAAO,CAACD,EAdS,SAACtG,GAChB,IAEE,IAAMwG,EAAexG,aAAiByG,SAAWzG,EAAMsG,GAAetG,EAEtEuG,EAAeC,GAEfV,OAAOC,aAAaW,QAAQ7E,EAAKoE,KAAKU,UAAUH,IAChD,MAAOL,GAGPC,QAAQC,IAAIF,OCdZS,GAAkB,CACtBxH,MAAO,GACPa,OAAQ,GACR4G,iBAAkB,GAClBC,gBAAiB,GACjBC,IAAK,EACLC,IAAK,GAIDC,GAAO,aAqBPC,GAAiBC,wBAAmC,CACxDC,QAASR,GACTS,WAAYJ,GACZK,MAAOL,GACPM,QAASN,GACTO,WAAYP,GACZQ,UAAWR,GACXS,UAAWT,GACXU,aAAcV,GACdW,oBAAqBX,GACrBY,YAAa,GACbnI,SAAU,EACVmB,MAAO,EACPiH,kBAAmB,kBAAM,GACzBC,aAAc,kBAAM,GACpBC,aAAc,kBAAM,GACpBC,eAAgB,kBAAM,KAGXC,GAA4C,SAAC,GAAkB,IAAhBnG,EAAe,EAAfA,SAAe,EAC3C6D,GAA+B,UAAWgB,IADC,mBAClEQ,EADkE,KACzDC,EADyD,KA2EnEQ,EAAcxI,mBAAgC,WAClD,OAAO+H,EAAQhI,MAAMO,QAAO,SAACH,EAAK2I,GAAN,mBAAC,eAAoB3I,GAArB,mBAA2B2I,EAAKzJ,GAAKyJ,EAAKpI,SAAS,MAC9E,CAACqH,EAAQhI,QAENM,EAAWL,mBACf,kBACE+H,EAAQhI,MAAMO,QAAO,SAACyI,EAAeC,GACnC,OAAOxI,IAASuI,GAAetI,IAAIuI,EAAatI,MAAMC,QACrD,KACL,CAACoH,EAAQhI,QAGLyB,EAAQhB,IAASH,GAAUI,IAAIsH,EAAQJ,KAAKlH,IAAIsH,EAAQL,KAAK/G,MAE7D8H,EAAoB,SAAC1H,GAAD,aACxB,UAAAgH,EAAQP,iBAAiBzG,UAAzB,eAAoCT,QAClC,SAACC,EAAKS,GAAN,OACER,IAASD,GAAKE,IAAID,IAASgI,EAAYxH,IAASa,OAAOkG,EAAQN,gBAAgBzG,GAAQiI,SAAStI,QAClG,KACG,GAEDuI,EAAmB,SAACnI,GAAD,OAAsB0H,EAAkB1H,GAAYV,GAEvEqI,EAAe,SAAC3H,GAAD,OAAsBP,IAASuH,EAAQJ,KAAK7F,SAASoH,EAAiBnI,IAAWJ,OAChGgI,EAAe,SAAC5H,GAAD,OAAsBP,IAASuH,EAAQL,KAAK5F,SAASoH,EAAiBnI,IAAWJ,OAKtG,OACE,cAACkH,GAAesB,SAAhB,CACExI,MAAO,CACLoH,UACAC,aACAC,MA1GQ,WACZD,EAAWT,KA0GPW,QAvGU,SAACkB,GACfpB,GAAW,SAACqB,GACV,IAAMC,EAAQD,EAAKtJ,MAAMI,KAAI,SAACC,GAAD,OAAUA,EAAKf,MAAIkK,QAAQH,EAAQ/J,IAChE,OAAIiK,GAAS,GACXD,EAAKtJ,MAAMuJ,GAASF,EACb,2BAAKC,GAAZ,IAAkBtJ,MAAM,YAAKsJ,EAAKtJ,UAE3B,2BAAKsJ,GAAZ,IAAkBtJ,MAAM,GAAD,mBAAMsJ,EAAKtJ,OAAX,CAAkBqJ,UAiGzCjB,WA5Fa,SAACnH,GAClBgH,GAAW,SAACqB,GAAD,mBAAC,eAAeA,GAAhB,IAAsBtJ,MAAOsJ,EAAKtJ,MAAMyJ,QAAO,SAACpJ,GAAD,OAAUA,EAAKf,KAAO2B,WA4F5EoH,UAzFY,SAACpH,GACjB,IAAMZ,EAAO2H,EAAQhI,MAAM0J,MAAK,SAACrJ,GAAD,OAAUA,EAAKf,KAAO2B,KACtD,GAAKZ,EAAL,CACA,IAAMsJ,EAAaC,SACjBC,OAAO,0BAAD,OAA2BxJ,EAAK0F,KAAhC,cAA0CtF,IAASJ,EAAKM,MAAMgE,SAA9D,sBAA6F,IAErG,GAAKgF,IAAcG,MAAMH,GAAzB,CACA,IFzFuBT,EEyFjBa,GFzFiBb,EEyFoBS,EFzFS,IAAIK,MAAMd,GAAQe,KAAK,GAAG7J,KAAI,SAAC8J,EAAGX,GAAJ,OAAcA,MEyFzCnJ,KAAI,iBAAO,CAChEd,GAAI6K,cACJpE,KAAM1F,EAAK0F,KACXpF,KAAMN,EAAKM,KAAOgJ,MAEpB1B,GAAW,SAACqB,GAAD,mBAAC,eAAeA,GAAhB,IAAsBtJ,MAAM,GAAD,mBAAMsJ,EAAKtJ,MAAMyJ,QAAO,SAACpJ,GAAD,OAAUA,EAAKf,KAAO2B,MAA9C,YAA0D8I,YA8E5FzB,UA3EY,SAAC8B,GACjBnC,GAAW,SAACqB,GACV,IAAMC,EAAQD,EAAKzI,OAAOT,KAAI,SAACC,GAAD,OAAUA,EAAKf,MAAIkK,QAAQY,EAAU9K,IACnE,OAAIiK,GAAS,GACXD,EAAKzI,OAAO0I,GAASa,EACd,2BAAKd,GAAZ,IAAkBzI,OAAO,YAAKyI,EAAKzI,WAE5B,2BAAKyI,GAAZ,IAAkBzI,OAAO,GAAD,mBAAMyI,EAAKzI,QAAX,CAAmBuJ,UAqE3C7B,aAhEe,SAACvH,GACpBiH,GAAW,SAACqB,GAAD,mBAAC,eAAeA,GAAhB,IAAsBzI,OAAQyI,EAAKzI,OAAO4I,QAAO,SAAC3I,GAAD,OAAYA,EAAOxB,KAAO0B,WAgElFwH,oBA7DsB,SAACvH,EAAgBoJ,EAAqBC,GAChErC,GAAW,SAACqB,GAAU,IAAD,EACX7B,EAAsC6B,EAAtC7B,iBAAkBC,EAAoB4B,EAApB5B,gBADP,cAEI2C,GAFJ,yBAERrJ,EAFQ,QAGZyG,EAAiBzG,KAAWyG,EAAiBzG,GAAY,IAE5DyG,EAAiBzG,GADfsJ,EAC2BjE,GAAO,GAAD,mBAAKoB,EAAiBzG,IAAtB,CAAiCC,KAEvCwG,EAAiBzG,GAAUyI,QAAO,SAACc,GAAD,OAAaA,IAAYtJ,KAErFyG,EAAgBzG,KAASyG,EAAgBzG,GAAU,IAEtDyG,EAAgBzG,GADdqJ,EACwBjE,GAAO,GAAD,mBAAKqB,EAAgBzG,IAArB,CAA8BD,KAEpC0G,EAAgBzG,GAAQwI,QAAO,SAACe,GAAD,OAAeA,IAAcxJ,MAX1F,2BAAmC,IAFhB,8BAgBnB,OAAO,2BAAKsI,GAAZ,IAAkB7B,mBAAkBC,wBA6ClCe,cACAnI,WACAmB,QACAiH,oBACAC,eACAC,eACAC,eArBiB,SAAC7H,GAAD,OACrBP,IAASiI,EAAkB1H,IAAWN,IAAIiI,EAAa3H,IAAWN,IAAIkI,EAAa5H,IAAWJ,QAG9F,SAoBG+B,KAMQ8H,GADI,kBAA2BC,qBAAW5C,K,mDC9F1C6C,GAnGO,SAAC,GAgBF,IAfnB/J,EAekB,EAflBA,MAekB,IAdlB8E,gBAckB,MAdP,aAcO,MAblBkF,mBAakB,MAbJ,SAAChK,GAAD,gBAAcA,IAaV,EAZlBiF,EAYkB,EAZlBA,KAYkB,IAXlBgF,gBAWkB,aAVlB5G,aAUkB,MAVV,GAUU,MATlB6G,iBASkB,MATN,QASM,IACkBvL,oBAAS,GAD3B,mBACXwL,EADW,KACCC,EADD,KAEZC,EAAeC,mBACfC,EAAQC,cAHI,EAKgB7L,mBAASqB,GALzB,mBAKXyK,EALW,KAKAC,EALA,KAOlB1L,qBAAU,WACR0L,EAAa1K,KACZ,CAACA,IAEJ2K,2BAAgB,WAAO,IAAD,EAChBR,IAAY,UAAAE,EAAaO,eAAb,SAAsBC,WACrC,CAACV,IAEJ,IAQMW,EAAsB,CAC1BC,WAAY,MACZC,cAAe,MACfjI,QAAS,cACTC,cAAe,SACfK,SAGI4H,EACJ,cAAC/H,EAAA,EAAD,CAAYgI,MAAOhB,EAAWrH,GAAI,CAAEQ,MAAO,QAA3C,SACG2G,EAAYhK,KAIXmL,EACJ,cAAC1G,EAAA,EAAD,CACE5B,GAAI,CACFuI,UAAW,MACXC,OAAQ,MACRhI,MAAO,OACPiI,gBAAiBf,EAAMgB,QAAQC,KAAKvB,SACpCwB,QAASxB,EAAW,EAAI,KAK9B,OAAOE,EACL,cAACzF,EAAA,EAAD,CACE1E,MAAOyK,EACP3F,SAAU,SAACT,GAAD,OAAWqG,EAAarG,EAAMU,OAAO/E,QAC/CiF,KAAMA,EACNyG,OAAQ,kBAAMtB,GAAc,IAC5BuB,QAxCgB,SAACtH,GACnBqG,EAAa1K,GACb4L,YAAW,WACTvH,EAAMU,OAAO8G,kBAAkB,EAAGxH,EAAMU,OAAO/E,MAAMsI,UACpD,MAqCDwD,UAAW,SAACzH,GACN,CAAC,SAAS0H,SAAS1H,EAAM2H,QAC3B5B,GAAc,GACdtF,EAAS2F,IAEP,CAAC,UAAUsB,SAAS1H,EAAM2H,OAC5B5B,GAAc,IAGlB6B,SAAU5B,EACVxH,GAAI,CAAEQ,SACNwB,QAAS,WACTqH,WAAY,CAAElK,MAAO,CAAEkI,gBAEvBD,EACF,eAACxF,EAAA,EAAD,CAAK5B,GAAIiI,EAAT,UACGG,EACAE,KAGH,eAACgB,GAAA,EAAD,CAAYC,QAAS,kBAAMhC,GAAc,IAAOvH,GAAIiI,EAApD,UACGG,EACAE,M,UChEDkB,GAAgD,CACpDlH,KAAM,GACNpF,UAAMuM,GAeFC,GAAcC,YAAOC,IAAPD,EAAc,iBAAO,CACvClB,gBAAiB,QACjB,OAAQ,CACNoB,WAAY,cAyWDC,GArWqB,WAAO,IAAD,EAcpC9C,KAZFxC,EAFsC,EAEtCA,WAFsC,IAGtCD,QAAWhI,EAH2B,EAG3BA,MAAOa,EAHoB,EAGpBA,OAAQ4G,EAHY,EAGZA,iBAAkBC,EAHN,EAGMA,gBAAiBE,EAHvB,EAGuBA,IAAKD,EAH5B,EAG4BA,IAClEQ,EAJsC,EAItCA,QACAC,EALsC,EAKtCA,WACAC,EANsC,EAMtCA,UACAG,EAPsC,EAOtCA,oBACAlI,EARsC,EAQtCA,SACAoI,EATsC,EAStCA,kBACAjH,EAVsC,EAUtCA,MACAkH,EAXsC,EAWtCA,aACAC,EAZsC,EAYtCA,aACAC,EAbsC,EAatCA,eAGa2E,EAAa/C,KAApBvC,MAhBgC,EAsBCuF,YAAuB,CAAEC,cAAeT,KAAzEU,EAtBgC,EAsBhCA,QAASC,EAtBuB,EAsBvBA,aAAc1F,EAtBS,EAsBTA,MAEzB2F,EAAe3C,iBAAgC,MAC/C4C,EAAe5C,iBAAgC,MAE/C6C,EAAiB,SAAC,GAAmC,IAAD,EAAhChI,EAAgC,EAAhCA,KAAMpF,EAA0B,EAA1BA,KACxB0I,EAAU,CACd/J,GAAI6K,cACJpE,OACApF,QAEFwH,EAAQkB,GACRnB,EAAM+E,IACN,UAAAY,EAAarC,eAAb,SAAsBC,SAGlBuC,EAAkB,SAACjI,GAAD,OAAoC,SAACd,GAEnC,IAAD,EADJ,UAAfA,EAAM2H,OACK,SAAT7G,EACF,UAAA+H,EAAatC,eAAb,SAAsBC,QACJ,SAAT1F,GACT6H,EAAaG,EAAbH,CAA6B3I,MAK7BkG,EAAQC,cAEd,OACE,qCACE,cAACxF,EAAA,EAAD,CAAQoH,QAlCQ,WACdiB,QAAQ,sCAAsCT,KAiClB5K,MAAO,CAAEE,MAAO,WAA9C,mBAGA,cAACgB,EAAA,EAAD,kCACA,eAACoK,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,UACE,cAACF,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAf,SACE,sBAAMrJ,SAAU4I,EAAaG,GAA7B,SACE,eAACG,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAGE,WAAY,WAAxC,UACE,cAACJ,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAIE,GAAI,EAAvB,SACE,cAAC,IAAD,CACEZ,QAASA,EACT5H,KAAM,OACNyI,OAAQ,gBAAGC,EAAH,EAAGA,MAAH,OACN,cAACnJ,EAAA,EAAD,2BACMmJ,GADN,IAEE5B,SAAU,SAAC1N,GACT0O,EAAarC,QAAUrM,EACvBsP,EAAMtP,IAAIA,IAEZoG,MAAM,YACNC,WAAS,EACTkH,UAAWsB,EAAgB,gBAKnC,cAACE,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAIE,GAAI,EAAvB,SACE,cAAC,IAAD,CACEZ,QAASA,EACT5H,KAAM,OACNyI,OAAQ,gBAAGC,EAAH,EAAGA,MAAH,OACN,cAACnJ,EAAA,EAAD,2BACMmJ,GADN,IAEE5B,SAAU,SAAC1N,GACT2O,EAAatC,QAAUrM,EACvBsP,EAAMtP,IAAIA,IAEZoG,MAAM,OACNC,WAAS,EACTkH,UAAWsB,EAAgB,QAC3BnI,KAAM,aAGV6I,MAAO,CAAEC,UAAU,OAGvB,cAACT,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAIE,GAAI,EAAvB,SACE,cAAC3I,EAAA,EAAD,CAAQH,QAAS,YAAa3C,MAAO,UAAW0C,WAAS,EAACK,KAAM,SAAhE,0BAOR,cAACqI,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAf,SACE,cAAChJ,EAAA,EAAD,CAAKzC,MAAO,CAAEgM,SAAU,OAAQC,SAAU,YAA1C,SACE,eAAC1B,GAAD,WACE,cAAC2B,EAAA,EAAD,UACE,eAACC,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,CACEpM,MAAO,CAAEiM,SAAU,SAAUI,KAAM,EAAG/C,gBAAiB,QAASgD,OAAQ,IAAKC,SAAU,KADzF,kBAKA,cAACH,EAAA,EAAD,CAAWpM,MAAO,CAAEuM,SAAU,KAA9B,kBACA,cAACH,EAAA,EAAD,CAAWpM,MAAO,CAAEqB,MAAO,KAC1BpD,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,CAA2BpM,MAAO,CAAEqB,MAAO,GAA3C,SACE,cAACmL,EAAA,EAAD,CAAS1K,MAAO5D,EAAOiF,KAAvB,SACE,cAACsJ,EAAA,EAAD,CAAQzM,MAAO,CAAEqJ,OAAQ,GAAIhI,MAAO,GAAIqL,SAAU,IAAlD,SAAyDxJ,GAAehF,EAAOiF,WAFnEjF,EAAOxB,OAMzB,cAAC0P,EAAA,EAAD,SAGJ,eAACO,EAAA,EAAD,WACGvP,EAAMI,KAAI,SAACC,GAAD,eACT,eAAC0O,EAAA,EAAD,CAEEnM,MAAO,CACLsJ,gBAA6D,MAA3C,UAAAxE,EAAgBrH,EAAKf,WAArB,eAA0B4J,SAAU,GAAWsG,KAAM,KAAO,SAHlF,UAME,cAACR,EAAA,EAAD,CACEpM,MAAO,CACLiM,SAAU,SACVI,KAAM,EACNC,OAAQ,IACRhD,gBAA6D,MAA3C,UAAAxE,EAAgBrH,EAAKf,WAArB,eAA0B4J,SAAU,GAAWsG,KAAM,KAAO,SALlF,SAQE,cAAC,GAAD,CAAe5O,MAAOP,EAAK0F,KAAML,SAAU,SAACK,GAAD,OAAUoC,EAAQ,2BAAK9H,GAAN,IAAY0F,eAE1E,cAACiJ,EAAA,EAAD,UACE,cAAC,GAAD,CACEnJ,KAAM,SACNjF,MAAO6O,OAAOpP,EAAKM,MACnB+E,SAAU,SAAC9E,GAAD,OAAWuH,EAAQ,2BAAK9H,GAAN,IAAYM,KAAM4B,WAAW3B,OACzDgK,YAAa,SAAChK,GAAD,OAAWH,IAASG,GAAO+D,cAG5C,cAACqK,EAAA,EAAD,UACE,eAAC3J,EAAA,EAAD,CAAKzC,MAAO,CAAEe,QAAS,QAAvB,UACE,cAAC+L,EAAA,EAAD,CACEC,KAAM,QACNC,KAAK,MACL5C,QAAS,kBAAM3E,EAAUhI,EAAKf,KAC9BsD,MAAO,CAAEiN,YAAa1E,EAAMiD,QAAQ,IAJtC,SAME,cAAC,KAAD,CAAetL,MAAO,cAExB,cAAC4M,EAAA,EAAD,CACEC,KAAM,QACNC,KAAK,MACL5C,QAAS,WACHiB,QAAQ,iDAAiD7F,EAAW/H,EAAKf,KAJjF,SAOE,cAAC,KAAD,CAAYwD,MAAO,iBAIxBjC,EAAOT,KAAI,SAACU,GAAD,aACV,cAACkO,EAAA,EAAD,UACE,cAACc,EAAA,EAAD,CACEC,SAAS,UAAAtI,EAAiB3G,EAAOxB,WAAxB,eAA6BqN,SAAStM,EAAKf,OAAO,EAC3DoG,SAAU,SAACT,GAAD,OAAWuD,EAAoBnI,EAAKf,GAAI,CAACwB,EAAOxB,IAAK2F,EAAMU,OAAOoK,aAHhEjP,EAAOxB,OAOzB,cAAC0P,EAAA,EAAD,CAAWpM,MAAO,CAAEqB,MAAO,GAA3B,SACE,cAAC2B,EAAA,EAAD,CACEoH,QAAS,wBACPxE,EACEnI,EAAKf,GACLuB,EAAOT,KAAI,SAACU,GAAD,OAAYA,EAAOxB,QAC9B,UAACmI,EAAiB5G,EAAO,GAAGvB,WAA5B,aAAC,EAAgCqN,SAAStM,EAAKf,OALrD,qBArDGe,EAAKf,OAoEd,eAACyP,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,CACEpM,MAAO,CACLiM,SAAU,SACVI,KAAM,EACN/C,gBAAiB,QACjBgD,OAAQ,IACR5B,WAAY,UANhB,SASE,cAACxJ,EAAA,EAAD,yBAEF,cAACkL,EAAA,EAAD,UACE,cAAClL,EAAA,EAAD,UAAarD,IAASH,GAAUqE,aAElC,cAACqK,EAAA,EAAD,IACCnO,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,UACE,cAAClL,EAAA,EAAD,UAAarD,IAASiI,EAAkB5H,EAAOxB,KAAKqF,YADtC7D,EAAOxB,OAIzB,cAAC0P,EAAA,EAAD,OAGF,eAACD,EAAA,EAAD,CACEnM,MAAO,CACLsJ,gBAAyB,IAARtE,EAAY4H,KAAM,UAAOtC,GAF9C,UAKE,cAAC8B,EAAA,EAAD,CACEpM,MAAO,CACLiM,SAAU,SACVI,KAAM,EACNC,OAAQ,IACR5B,WAAY,SACZpB,gBAAyB,IAARtE,EAAY4H,KAAM,KAAO,SAN9C,SASE,eAACnK,EAAA,EAAD,CACEzC,MAAO,CACLe,QAAS,OACT2K,WAAY,UAHhB,UAME,cAACxK,EAAA,EAAD,CAAYlB,MAAO,CAAEiN,YAAa,IAAlC,iBACA,cAAC,GAAD,CACEhK,KAAM,SACNjF,MAAO6O,OAAOnP,EAAW,EAAIsH,EAAMtH,EAAW,GAC9CoF,SAAU,SAACsK,GAAD,OACR/H,GAAW,SAACqB,GAAD,mBAAC,eAAeA,GAAhB,IAAsB1B,IAAKtH,GAAYiC,WAAWyN,GAAU,WAEzEpF,YAAa,SAAChK,GAAD,iBAAmC,IAApB2B,WAAW3B,IAAcqP,QAAQ,GAAhD,aAInB,cAACjB,EAAA,EAAD,UACE,cAAC,GAAD,CACEnJ,KAAM,SACNjF,MAAO6O,OAAO7H,GACdlC,SAAU,SAACkC,GAAD,OAASK,GAAW,SAACqB,GAAD,mBAAC,eAAeA,GAAhB,IAAsB1B,IAAKrF,WAAWqF,SACpEgD,YAAa,SAAChK,GAAD,OAAWH,IAASG,GAAO+D,cAG5C,cAACqK,EAAA,EAAD,IACCnO,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,UACE,cAAClL,EAAA,EAAD,UAAarD,IAASkI,EAAa7H,EAAOxB,KAAKqF,YADjC7D,EAAOxB,OAIzB,cAAC0P,EAAA,EAAD,OAGF,eAACD,EAAA,EAAD,CACEnM,MAAO,CACLsJ,gBAAyB,IAARvE,EAAY6H,KAAM,UAAOtC,GAF9C,UAKE,cAAC8B,EAAA,EAAD,CACEpM,MAAO,CACLiM,SAAU,SACVI,KAAM,EACN/C,gBAAyB,IAARvE,EAAY6H,KAAM,KAAO,QAC1CN,OAAQ,IACR5B,WAAY,UANhB,SASE,eAACjI,EAAA,EAAD,CACEzC,MAAO,CACLe,QAAS,OACT2K,WAAY,UAHhB,UAME,cAACxK,EAAA,EAAD,CAAYlB,MAAO,CAAEiN,YAAa,IAAlC,iBACA,cAAC,GAAD,CACEhK,KAAM,SACNjF,MAAO6O,OAAOnP,EAAW,EAAIqH,EAAMrH,EAAW,GAC9CoF,SAAU,SAACwK,GAAD,OACRjI,GAAW,SAACqB,GAAD,mBAAC,eAAeA,GAAhB,IAAsB3B,IAAKrH,GAAYiC,WAAW2N,GAAU,WAEzEtF,YAAa,SAAChK,GAAD,iBAAmC,IAApB2B,WAAW3B,IAAcqP,QAAQ,GAAhD,aAInB,cAACjB,EAAA,EAAD,UACE,cAAC,GAAD,CACEnJ,KAAM,SACNjF,MAAO6O,OAAO9H,GACdjC,SAAU,SAACiC,GAAD,OAASM,GAAW,SAACqB,GAAD,mBAAC,eAAeA,GAAhB,IAAsB3B,IAAKpF,WAAWoF,SACpEiD,YAAa,SAAChK,GAAD,OAAWH,IAASG,GAAO+D,cAG5C,cAACqK,EAAA,EAAD,IACCnO,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,UACE,cAAClL,EAAA,EAAD,UAAarD,IAASmI,EAAa9H,EAAOxB,KAAKqF,YADjC7D,EAAOxB,OAIzB,cAAC0P,EAAA,EAAD,OAGF,eAACD,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,CACEpM,MAAO,CACLiM,SAAU,SACVI,KAAM,EACN/C,gBAAiB,QACjBgD,OAAQ,IACR5B,WAAY,UANhB,SASE,cAACxJ,EAAA,EAAD,sBAEF,cAACkL,EAAA,EAAD,CAAWpM,MAAO,CAAE+I,WAAY,EAAGC,cAAe,GAAlD,SACE,cAAC9H,EAAA,EAAD,UAAarD,IAASgB,GAAOkD,aAE/B,cAACqK,EAAA,EAAD,IACCnO,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,CAA2BpM,MAAO,CAAE+I,WAAY,EAAGC,cAAe,GAAlE,SACE,cAAC9H,EAAA,EAAD,CACEkJ,QAAS,WACPtG,OAAOyJ,SAASC,KAtWd,SAAC,GAAD,QAC1BC,WAD0B,MACpB,SADoB,MAE1BC,YAF0B,MAEnB,GAFmB,EAG1BC,EAH0B,EAG1BA,OAH0B,IAI1BC,YAJ0B,MAInB,gBAJmB,wCAUGH,EAVH,uBAUqBC,EAVrB,mBAUoCC,EAVpC,iBAUmDC,GA4V9BC,CAAoB,CAAEF,OAAQ1H,EAAe/H,EAAOxB,OAF/E,SAKGmB,IAASoI,EAAe/H,EAAOxB,KAAKqF,YANzB7D,EAAOxB,OAUzB,cAAC0P,EAAA,EAAD,wB,oBC3TH0B,GAtEsB,WAAO,IAAD,EAKrCjG,KAHS5J,EAF4B,EAEvCmH,QAAWnH,OACXyH,EAHuC,EAGvCA,UACAC,EAJuC,EAIvCA,aAJuC,EAOKhJ,mBAAS,IAPd,mBAOlCoR,EAPkC,KAOjBC,EAPiB,KASnCC,EAAkB,SAAC9K,GAClBA,IACLuC,EAAU,CAAEhJ,GAAI6K,cAAUpE,KAAMA,EAAK+K,SACrCF,EAAmB,MASrB,OACE,qCACE,cAAC9M,EAAA,EAAD,2BACA,eAACoK,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,UACE,cAACF,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAf,SACE,eAACH,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAGE,WAAY,WAAxC,UACE,cAACJ,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAIE,GAAI,GAAvB,SACE,cAACjJ,EAAA,EAAD,CACE1E,MAAO+P,EACPjL,SAAU,SAACT,GAAD,OAAW2L,EAAmB3L,EAAMU,OAAO/E,QACrD2E,MAAM,cACNC,WAAS,EACTkH,UAlBU,SAACzH,GACJ,UAAfA,EAAM2H,MACRiE,EAAgBF,QAmBV,cAACzC,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAIE,GAAI,EAAvB,SACE,cAAC3I,EAAA,EAAD,CACEH,QAAS,YACT3C,MAAO,UACPkK,QAAS,kBAAM6D,EAAgBF,IAC/BnL,WAAS,EAJX,wBAWN,cAAC0I,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAf,SACE,cAACnK,EAAA,EAAD,UACGrD,EAAOT,KAAI,SAACU,GAAD,OACV,eAACyD,EAAA,EAAD,WACE,cAACwM,GAAA,EAAD,UACE,cAAC1B,EAAA,EAAD,UAASvJ,GAAehF,EAAOiF,UAEjC,cAAC,GAAD,CAAenF,MAAOE,EAAOiF,KAAML,SAAU,SAACK,GAAD,OAAUuC,EAAU,2BAAKxH,GAAN,IAAciF,aAC9E,cAACiL,GAAA,EAAD,UACE,cAACtB,EAAA,EAAD,CAAYE,KAAK,MAAM5C,QAAS,kBAAMzE,EAAazH,EAAOxB,KAA1D,SACE,cAAC,KAAD,UAPSwB,EAAOxB,kB,8BCjEvB2R,GAA+B,WAAO,IAAD,EACN1R,oBAAS,GADH,mBACzC2R,EADyC,KAC1BC,EAD0B,OAGoD1G,KAA5FzC,EAHwC,EAGxCA,QAASU,EAH+B,EAG/BA,kBAAmBC,EAHY,EAGZA,aAAcC,EAHF,EAGEA,aAAcC,EAHhB,EAGgBA,eAAgBvI,EAHhC,EAGgCA,SAAUmB,EAH1C,EAG0CA,MAE1F,OACE,cAAC4D,EAAA,EAAD,CAAKzC,MAAO,CAAEwO,aAAc,IAA5B,SACE,cAAC7N,EAAA,EAAD,UACE,eAAC8N,GAAA,EAAD,WACE,cAACzL,EAAA,EAAD,CAAQoH,QAAS,kBAAMmE,GAAiB,SAAC7H,GAAD,OAAWA,MAAnD,mBACA,cAACgI,GAAA,EAAD,CAAUC,GAAIL,EAAd,SACE,eAACM,GAAA,EAAD,WACE,cAAC,GAAD,CAAsBC,YAAa,UAAnC,SACE,8BAAM5K,KAAKU,UAAUS,EAAS,KAAM,OAEtC,eAAC,GAAD,CAAsByJ,YAAa,YAAnC,UACE,gCACE,eAAC3N,EAAA,EAAD,yBAAwBrD,IAASH,GAAUqE,SAA3C,OACCqD,EAAQnH,OAAOT,KAAI,SAACU,GAAD,OAClB,gCACGA,EAAOiF,KADV,MACmBtF,IAASiI,EAAkB5H,EAAOxB,KAAKqF,WADhD7D,EAAOxB,OAInB,wCACQ,IACL0I,EAAQnH,OACNN,QAAO,SAACC,EAAKM,GAAN,OAAiBN,EAAIE,IAAIgI,EAAkB5H,EAAOxB,OAAMmB,IAAS,IACxEkE,eAGP,gCACE,eAACb,EAAA,EAAD,mBAAkBrD,IAASuH,EAAQJ,KAAKjD,SAAxC,OACCqD,EAAQnH,OAAOT,KAAI,SAACU,GAAD,OAClB,gCACGA,EAAOiF,KADV,MACmBtF,IAASkI,EAAa7H,EAAOxB,KAAKqF,WAD3C7D,EAAOxB,OAInB,wCACQ,IACL0I,EAAQnH,OAAON,QAAO,SAACC,EAAKM,GAAN,OAAiBN,EAAIE,IAAIiI,EAAa7H,EAAOxB,OAAMmB,IAAS,IAAIkE,eAG3F,gCACE,eAACb,EAAA,EAAD,mBAAkBrD,IAASuH,EAAQL,KAAKhD,SAAxC,OACCqD,EAAQnH,OAAOT,KAAI,SAACU,GAAD,OAClB,gCACGA,EAAOiF,KADV,MACmBtF,IAASmI,EAAa9H,EAAOxB,KAAKqF,WAD3C7D,EAAOxB,OAInB,wCACQ,IACL0I,EAAQnH,OAAON,QAAO,SAACC,EAAKM,GAAN,OAAiBN,EAAIE,IAAIkI,EAAa9H,EAAOxB,OAAMmB,IAAS,IAAIkE,eAG3F,gCACE,eAACb,EAAA,EAAD,qBAAoBrD,IAASgB,GAAOkD,SAApC,OACCqD,EAAQnH,OAAOT,KAAI,SAACU,GAAD,OAClB,gCACGA,EAAOiF,KADV,MACmBtF,IAASoI,EAAe/H,EAAOxB,KAAKqF,WAD7C7D,EAAOxB,OAInB,wCACQ,IACL0I,EAAQnH,OAAON,QAAO,SAACC,EAAKM,GAAN,OAAiBN,EAAIE,IAAImI,EAAe/H,EAAOxB,OAAMmB,IAAS,IAAIkE,+BAYvG+M,GAAmE,SAAC,GAA+B,IAA7B/O,EAA4B,EAA5BA,SAAU8O,EAAkB,EAAlBA,YAAkB,EAC9ElS,oBAAS,GADqE,mBAC/FoS,EAD+F,KACzFC,EADyF,KAGtG,OACE,qCACE,cAAChM,EAAA,EAAD,CAAQoH,QAAS,kBAAM4E,GAAQ,SAACtI,GAAD,OAAWA,MAA1C,SAAkDmI,IAClD,cAACH,GAAA,EAAD,CAAUC,GAAII,EAAd,SAAqBhP,QCpDZkP,GA3BgB,WAAO,IAAD,EACCtS,mBAAS,GADV,mBAC5BuS,EAD4B,KAChBC,EADgB,KAGnC,OACE,8BACE,eAAC,GAAD,WACE,eAACxO,EAAA,EAAD,WACE,eAACyO,EAAA,EAAD,CACEpR,MAAOkR,EACPpM,SAAU,SAACT,EAAOrE,GAAR,OAAkBmR,EAAcnR,IAC1CqR,eAAe,UACfC,UAAU,UACVC,UAAQ,EACRvP,MAAO,CAAEwO,aAAc,IANzB,UAQE,cAACgB,EAAA,EAAD,CAAK7M,MAAM,UACX,cAAC6M,EAAA,EAAD,CAAK7M,MAAM,cAEG,IAAfuM,GAAoB,cAAC,GAAD,IACL,IAAfA,GAAoB,cAAC,GAAD,OAEvB,cAAC,GAAD,U,uECcF3E,GAAcC,YAAOC,IAAPD,EAAc,iBAAO,CACvClB,gBAAiB,QACjB,OAAQ,CACNoB,WAAY,SACZ3B,WAAY,MACZC,cAAe,WAIbyG,GAAiB7C,KAAM,KAiPd8C,GA/O4B,WAAO,IACxCpQ,EAAcqQ,cAAdrQ,UADuC,EAa3C7C,EAAc6C,GAThBxC,EAJ6C,EAI7CA,QACAM,EAL6C,EAK7CA,MACAM,EAN6C,EAM7CA,SACAmB,EAP6C,EAO7CA,MACAZ,EAR6C,EAQ7CA,OACAE,EAT6C,EAS7CA,sBACAQ,EAV6C,EAU7CA,kBACAK,EAX6C,EAW7CA,mBACAI,EAZ6C,EAY7CA,kBAGIwQ,EAAgCC,uBAAY,WAChD,IAAMrK,EAAU,uCAAG,WAAOnH,GAAP,SAAAC,EAAA,yDACZ+M,QAAQ,gDADI,oDAEZvO,GAAYuB,EAFA,iEAGXhC,EAAYG,MAAMM,EAAQJ,IAAIF,MAAM,SAASA,MAAM6B,GAAQyR,SAHhD,2CAAH,sDAMhB,OAAKhT,EAGH,cAACiT,GAAA,EAAD,CAAgBC,UAAW5O,IAA3B,SACE,eAAC,GAAD,WACE,cAAC8K,EAAA,EAAD,UACE,eAACC,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,IACA,cAACA,EAAA,EAAD,CAAWvL,GAAI,CAAEQ,MAAO,MAAQ6H,MAAM,QAAtC,sBAGA,cAACkD,EAAA,EAAD,CAAWlD,MAAM,QAAQrI,GAAI,CAAEQ,MAAO,MAAtC,kBAGCpD,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,CAA2BvL,GAAI,CAAEQ,MAAO,MAAxC,SACE,cAACoB,EAAA,EAAD,CAAK5B,GAAI,CAAEE,QAAS,OAAQkP,eAAgB,UAA5C,SACE,cAACzD,EAAA,EAAD,CAAS1K,MAAO5D,EAAOiF,KAAvB,SACE,cAACsJ,EAAA,EAAD,CAAQzM,MAAO,CAAEqJ,OAAQ,GAAIhI,MAAO,GAAIqL,SAAU,IAAlD,SAAyDxJ,GAAehF,EAAOiF,aAHrEjF,EAAOxB,OAQzB,cAAC0P,EAAA,EAAD,CAAWvL,GAAI,CAAEQ,MAAO,aAG5B,eAACsL,EAAA,EAAD,WACoB,IAAjBvP,EAAMkJ,OACL,cAAC6F,EAAA,EAAD,UACE,cAACC,EAAA,EAAD,CAAWlD,MAAO,SAAUgH,QAAS,EAAIjS,EAAOqI,OAAhD,uCAKFlJ,EAAMI,KAAI,SAACC,GACT,IAAM0S,EX4Fe,SAACrT,EAAwBuB,GAA4B,IAAD,IACvF,OAAKvB,GAAYuB,EACVf,OAAO8S,OAAP,oBAActT,EAAQ0F,+BAAtB,aAAc,EAAkCnE,UAAhD,QAA2D,IAAIV,QACpE,SAACC,EAAD,UAAuBA,EAAvB,EAAQW,WACR,GAH8B,EW7FC8R,CAAsBvT,EAASW,EAAKf,KAAOe,EAAKc,SAEnE,OACE,eAAC4N,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,UACE,cAAC,GAAD,CACEpO,MAAOP,EAAK0F,KACZL,SAAU,SAAC9E,GAAD,OAAW4B,EAAuBN,EAAW7B,EAAKf,GAAI,OAAQsB,IACxEkK,UAAW,WAGf,cAACkE,EAAA,EAAD,CAAWlD,MAAO,QAAlB,SACE,cAAC,GAAD,CACElL,MAAO6O,OAAOpP,EAAKc,UACnBuE,SAAU,SAAC9E,GAAD,OACR4B,EAAuBN,EAAW7B,EAAKf,GAAI,WAAY+B,KAAKC,IAAI,EAAGsI,SAAShJ,UAIlF,cAACoO,EAAA,EAAD,CAAWlD,MAAO,QAAlB,SACE,cAAC,GAAD,CACElL,MAAOH,IAASJ,EAAKM,MAAMgE,SAC3Be,SAAU,SAAC9E,GAAD,OAAW4B,EAAuBN,EAAW7B,EAAKf,GAAI,OAAQmB,IAASG,GAAOA,YAG3FC,EAAOT,KAAI,SAACU,GACX,IAAMoS,EX0EY,SAACxT,EAAwBsB,EAAkBC,GAA4B,IAAD,QAC5G,OAAKvB,GAAYsB,GAAaC,GAC9B,qBAAO,QAAE,GAAD,UAACvB,EAAQ8B,+BAAT,QAAoC,IAAIR,UAAzC,QAAsD,IAAIC,UAAjE,aAAO,EAAmEE,gBAA1E,QAD6C,EW3EEgS,CAAyBzT,EAASoB,EAAOxB,GAAIe,EAAKf,IAE7E,OACE,cAAC0P,EAAA,EAAD,CAEEvL,GAAI,CACFQ,MAAO,KACPiI,gBAAkB6G,OAA8B7F,EAAjBmF,IAEjCvG,MAAO,SANT,SAQE,eAACzG,EAAA,EAAD,CAAK5B,GAAI,CAAEE,QAAS,cAAekP,eAAgB,SAAUvE,WAAY,UAAzE,UACE,cAACoB,EAAA,EAAD,CACEC,KAAM,QACN3C,QAAS,kBAAMjM,EAAsBD,EAAOxB,GAAIe,EAAKf,GAAI4T,EAAqB,IAC9ErI,SAAUqI,GAAsB,EAHlC,SAKE,cAAC,KAAD,MAEF,cAACpP,EAAA,EAAD,UAAa+C,KAAKU,UAAU2L,KAC5B,cAACxD,EAAA,EAAD,CACEC,KAAM,QACN3C,QAAS,kBAAMjM,EAAsBD,EAAOxB,GAAIe,EAAKf,GAAI4T,EAAqB,IAC9ErI,SAAUkI,EAHZ,SAKE,cAAC,KAAD,UArBCjS,EAAOxB,OA2BlB,cAAC0P,EAAA,EAAD,CAAWlD,MAAM,QAAjB,SACE,cAAC4D,EAAA,EAAD,CAAYC,KAAM,QAASC,KAAK,MAAM5C,QAAS,kBAAM5E,EAAW/H,EAAKf,KAArE,SACE,cAAC,KAAD,CAAYwD,MAAO,gBAxDVzC,EAAKf,OA+D1B,cAACyP,EAAA,EAAD,CAAUtL,GAAI,CAAEwI,OAAQ,GAAIC,gBAAiB,wBAC7C,eAAC6C,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,wBACA,cAACA,EAAA,EAAD,IACA,cAACA,EAAA,EAAD,CAAWlD,MAAO,QAAlB,SACE,cAAC,GAAD,CAAelL,MAAOH,IAASH,GAAUqE,SAAUkG,UAAQ,MAE5DhK,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,UACE,cAAC,GAAD,CAAepO,MAAOH,IAASc,EAAkBT,EAAOxB,KAAKqF,SAAUkG,UAAQ,KADjE/J,EAAOxB,OAIzB,cAAC0P,EAAA,EAAD,OAEF,eAACD,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,kBACA,cAACA,EAAA,EAAD,CAAWlD,MAAO,QAAlB,SACE,cAAC,GAAD,CACElL,MAAO6O,QACHhP,IAASf,EAAQiC,SAASf,MAAQH,IAASH,EAAW,EAAIA,EAAW,GAAGM,MAAS,KAAOqP,QACxF,IAGJrF,YAAa,SAAC7K,GAAD,gBAAYA,EAAZ,MACb2F,SAAU,SAAC0N,GAAD,OAAa/Q,EAAuBH,EAAW,UAAWkR,EAAS9S,QAGjF,cAAC0O,EAAA,EAAD,CAAWlD,MAAO,QAAlB,SACE,cAAC,GAAD,CACElL,MAAOH,IAASf,EAAQiC,SAASgD,SACjCe,SAAU,SAAC9E,GAAD,OAAWqB,EAAkBC,EAAW,UAAWtB,QAGhEC,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,UACE,cAAC,GAAD,CAAepO,MAAOH,IAASmB,EAAmB,UAAWd,EAAOxB,KAAKqF,SAAUkG,UAAQ,KAD7E/J,EAAOxB,OAIzB,cAAC0P,EAAA,EAAD,OAEF,eAACD,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,kBACA,cAACA,EAAA,EAAD,CAAWlD,MAAO,QAAlB,SACE,cAAC,GAAD,CACElL,MAAO6O,QACHhP,IAASf,EAAQgC,SAASd,MAAQH,IAASH,EAAW,EAAIA,EAAW,GAAGM,MAAS,KAAOqP,QACxF,IAGJrF,YAAa,SAAC7K,GAAD,gBAAYA,EAAZ,MACb2F,SAAU,SAAC0N,GAAD,OAAa/Q,EAAuBH,EAAW,UAAWkR,EAAS9S,QAGjF,cAAC0O,EAAA,EAAD,CAAWlD,MAAO,QAAlB,SACE,cAAC,GAAD,CACElL,MAAOH,IAASf,EAAQgC,SAASiD,SACjCe,SAAU,SAAC9E,GAAD,OAAWqB,EAAkBC,EAAW,UAAWtB,QAGhEC,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,UACE,cAAC,GAAD,CAAepO,MAAOH,IAASmB,EAAmB,UAAWd,EAAOxB,KAAKqF,SAAUkG,UAAQ,KAD7E/J,EAAOxB,OAIzB,cAAC0P,EAAA,EAAD,OAEF,eAACD,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,IACA,cAACA,EAAA,EAAD,IACA,cAACA,EAAA,EAAD,IACCnO,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,UACE,cAAC3J,EAAA,EAAD,CAAK5B,GAAI,CAAEE,QAAS,OAAQkP,eAAgB,UAA5C,SACE,cAACzD,EAAA,EAAD,CAAS1K,MAAO5D,EAAOiF,KAAvB,SACE,cAACsJ,EAAA,EAAD,CAAQzM,MAAO,CAAEqJ,OAAQ,GAAIhI,MAAO,GAAIqL,SAAU,IAAlD,SAAyDxJ,GAAehF,EAAOiF,aAHrEjF,EAAOxB,OAQzB,cAAC0P,EAAA,EAAD,OAEF,eAACD,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,oBACA,cAACA,EAAA,EAAD,IACA,cAACA,EAAA,EAAD,CAAWlD,MAAO,QAAlB,SACE,cAAC,GAAD,CAAelL,MAAOH,IAASgB,GAAOkD,SAAUkG,UAAQ,MAEzDhK,EAAOT,KAAI,SAACU,GAAD,OACV,cAACkO,EAAA,EAAD,UACE,cAAC,GAAD,CAAepO,MAAOH,IAASuB,EAAkBlB,EAAOxB,KAAKqF,SAAUkG,UAAQ,KADjE/J,EAAOxB,OAIzB,cAAC0P,EAAA,EAAD,eAjMW,+BAuMpB,CAAChP,IAEJ,OACE,mCACGN,GACC,eAACwO,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,UACE,cAACF,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAf,SACE,cAAC,GAAD,CAAa3O,QAASA,MAExB,cAACwO,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAf,SACE,cAACmE,EAAD,YAgBNa,GAAiD,CACrDtN,KAAM,GACNpF,KAAM,EACNQ,SAAU,GAGNmS,GAAwBC,OAAaC,MAAM,CAC/CzN,KAAMwN,OAAa5E,WACnBhO,KAAM4S,OAAaE,WAAW9E,WAC9BxN,SAAUoS,OAAaG,UAAUD,WAAW9E,aAGxCgF,GAA6D,SAAC,GAAiB,IAAfjU,EAAc,EAAdA,QAAc,EACzC+N,YAA0B,CACjEC,cAAe2F,GACfO,SAAUC,aAAYP,MAFhB3F,EAD0E,EAC1EA,QAASC,EADiE,EACjEA,aAAc1F,EADmD,EACnDA,MAKzB2F,EAAe3C,iBAAgC,MAC/C4C,EAAe5C,iBAAgC,MAC/C4I,EAAmB5I,iBAAgC,MAEnDlG,EAAQ,uCAAG,WAAO+O,GAAP,eAAA7S,EAAA,sDACfjC,EAAYG,MAAMM,EAAQJ,IAAIF,MAAM,SAASiE,KAAK0Q,GAClD7L,EAAMmL,IACN,UAAAxF,EAAarC,eAAb,SAAsBC,QAHP,2CAAH,sDAMRuC,EAAkB,SAACjI,GAAD,OAAuC,SAACd,GACjC,IAAD,EAC4B,EADrC,UAAfA,EAAM2H,OACK,SAAT7G,IAAoB,UAAC+H,EAAatC,eAAd,aAAC,EAAsB5K,OAC7C,UAAAkN,EAAatC,eAAb,SAAsBC,QACJ,SAAT1F,GAA4B,aAATA,GAC5B6H,EAAa5I,EAAb4I,CAAuB3I,MAKvB+O,EAAc,SAAC/O,GACnBuH,YAAW,WACTvH,EAAMU,OAAO8G,kBAAkB,EAAGxH,EAAMU,OAAO/E,MAAMsI,UACpD,MAGL,OACE,cAAClF,EAAA,EAAD,CAAOP,GAAI,CAAEwQ,EAAG,GAAhB,SACE,sBAAMjP,SAAU4I,EAAa5I,GAA7B,SACE,eAACkJ,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAGE,WAAY,WAAxC,UACE,cAACJ,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAIE,GAAI,EAAvB,SACE,cAAC,IAAD,CACEZ,QAASA,EACT5H,KAAM,OACNyI,OAAQ,gBAAGC,EAAH,EAAGA,MAAH,OACN,cAACnJ,EAAA,EAAD,2BACMmJ,GADN,IAEE5B,SAAU,SAAC1N,GACT0O,EAAarC,QAAUrM,EACvBsP,EAAMtP,IAAIA,IAEZsG,QAAS,WACTF,MAAM,YACNC,WAAS,EACTkH,UAAWsB,EAAgB,QAC3BzB,QAASyH,UAKjB,cAAC9F,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAI6F,GAAI,EAAG3F,GAAI,EAA9B,SACE,cAAC,IAAD,CACEZ,QAASA,EACT5H,KAAM,OACNyI,OAAQ,gBAAGC,EAAH,EAAGA,MAAH,OACN,cAACnJ,EAAA,EAAD,2BACMmJ,GADN,IAEE5B,SAAU,SAAC1N,GACT2O,EAAatC,QAAUrM,EACvBsP,EAAMtP,IAAIA,IAEZsG,QAAS,WACTF,MAAM,OACNC,WAAS,EACTkH,UAAWsB,EAAgB,QAC3BzB,QAASyH,EACTnO,KAAM,SACNiH,WAAY,CAAEqH,KAAM,MAAOC,IAAK,OAGpC1F,MAAO,CAAEC,UAAU,OAGvB,cAACT,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAI6F,GAAI,EAAG3F,GAAI,EAA9B,SACE,cAAC,IAAD,CACEZ,QAASA,EACT5H,KAAM,WACNyI,OAAQ,gBAAGC,EAAH,EAAGA,MAAH,OACN,cAACnJ,EAAA,EAAD,2BACMmJ,GADN,IAEE5B,SAAU,SAAC1N,GACT2U,EAAiBtI,QAAUrM,EAC3BsP,EAAMtP,IAAIA,IAEZsG,QAAS,WACTF,MAAM,WACNC,WAAS,EACTkH,UAAWsB,EAAgB,YAC3BzB,QAASyH,EACTnO,KAAM,SACNiH,WAAY,CAAEsH,IAAK,OAGvB1F,MAAO,CAAEC,UAAU,OAGvB,cAACT,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAIE,GAAI,EAAvB,SACE,cAAC3I,EAAA,EAAD,CAAQH,QAAS,YAAa3C,MAAO,UAAW0C,WAAS,EAACK,KAAM,SAAhE,2B,UCzSGwO,GA5F6B,WAAO,IACzCnS,EAAcqQ,cAAdrQ,UADwC,EAGpB7C,EAAc6C,GAAlCxC,EAHwC,EAGxCA,QAASmB,EAH+B,EAG/BA,OAH+B,EAKP4M,YAA4B,CACnEmG,SAAUC,aACRN,OAAaC,MAAM,CACjBzN,KAAMwN,OAAa5E,gBAHjBhB,EALwC,EAKxCA,QAASC,EAL+B,EAK/BA,aAAc1F,EALiB,EAKjBA,MAQzB2F,EAAe3C,iBAAgC,MAE/ClG,EAAW,SAAC+O,GACXrU,IACLT,EAAYG,MAAMM,EAAQJ,IAAIF,MAAM,UAAUiE,KAAK0Q,GACnD7L,EAAM,CAAEnC,KAAM,OAGViI,EAAkB,SAAC/I,GACJ,UAAfA,EAAM2H,MACRgB,EAAa5I,EAAb4I,CAAuB3I,IAIrB+O,EAAc,SAAC/O,GACnBuH,YAAW,WACTvH,EAAMU,OAAO8G,kBAAkB,EAAGxH,EAAMU,OAAO/E,MAAMsI,UACpD,MAGCX,EAAY,uCAAG,WAAOvH,GAAP,SAAAE,EAAA,yDACd+M,QAAQ,kDADM,oDAEdvO,GAAYsB,EAFE,iEAGb/B,EAAYG,MAAMM,EAAQJ,IAAIF,MAAM,UAAUA,MAAM4B,GAAU0R,SAHjD,2CAAH,sDAMlB,OACE,qCACE,cAAC5O,EAAA,EAAD,CAAY2B,QAAS,KAAMhC,GAAI,CAAEM,GAAI,GAArC,oBAGA,cAACC,EAAA,EAAD,UACE,eAACE,EAAA,EAAD,WACGrD,EAAOT,KAAI,SAACU,GAAD,OACV,cAACyD,EAAA,EAAD,UACE,eAACc,EAAA,EAAD,CAAK5B,GAAI,CAAEE,QAAS,OAAQ2K,WAAY,SAAUrK,MAAO,OAAQJ,IAAK,GAAtE,UACE,cAACkN,GAAA,EAAD,UACE,cAAC1B,EAAA,EAAD,UAASvJ,GAAehF,EAAOiF,UAEjC,cAAC,GAAD,CAAenF,MAAOE,EAAOiF,KAAM9B,MAAO,OAAQ6G,UAAW,SAC7D,cAAC4E,EAAA,EAAD,CAAYC,KAAM,QAASC,KAAK,MAAM5C,QAAS,kBAAMzE,EAAazH,EAAOxB,KAAzE,SACE,cAAC,KAAD,CAAYwD,MAAO,gBAPVhC,EAAOxB,QAYjB,OAANuB,QAAM,IAANA,OAAA,EAAAA,EAAQqI,QAAS,GAAK,cAACoL,GAAA,EAAD,CAAS7Q,GAAI,CAAE8Q,GAAI,EAAGxQ,GAAI,KACjD,sBAAMiB,SAAU4I,EAAa5I,GAA7B,SACE,cAACT,EAAA,EAAD,UACE,eAACc,EAAA,EAAD,CAAK5B,GAAI,CAAEQ,MAAO,OAAQN,QAAS,OAAQE,IAAK,QAAhD,UACE,cAAC,IAAD,CACE8J,QAASA,EACT5H,KAAM,OACNyI,OAAQ,gBAAGC,EAAH,EAAGA,MAAH,OACN,cAACnJ,EAAA,EAAD,2BACMmJ,GADN,IAEE5B,SAAU,SAAC1N,GACT0O,EAAarC,QAAUrM,EACvBsP,EAAMtP,IAAIA,IAEZsG,QAAS,WACTF,MAAM,cACNC,WAAS,EACTkH,UAAWsB,EACXzB,QAASyH,EACTvQ,GAAI,CAAEgB,KAAM,SAIlB,cAACmB,EAAA,EAAD,CAAQC,KAAM,SAAd,iC,UCpCD2O,GA9D4B,WAAO,IAAD,IACpBjC,cAAnBrQ,EADuC,EACvCA,UAAWuS,EAD4B,EAC5BA,IACbC,EAAUC,cAF+B,EAIRtV,EAAc6C,GAA7CxC,EAJuC,EAIvCA,QAASmB,EAJ8B,EAI9BA,OAAQrB,EAJsB,EAItBA,UAQzB,OANAI,qBAAU,WACHJ,GAAgC,KAAb,OAANqB,QAAM,IAANA,OAAA,EAAAA,EAAQqI,SACxBwL,EAAQrR,KAAKe,GAAOC,YAAYC,MAAM,CAAEpC,YAAWuS,IAAK,cAEzD,CAAC5T,EAAQrB,IAERA,EAEA,cAAC6F,EAAA,EAAD,CAAK5B,GAAI,CAAEE,QAAS,OAAQkP,eAAgB,SAAU0B,GAAI,GAA1D,SACE,cAACK,GAAA,EAAD,MAKJ,mCACE,cAACrR,EAAA,EAAD,CAAWC,SAAU,KAAMC,GAAI,CAAEkI,WAAY,GAA7C,SACE,eAACuC,EAAA,EAAD,CAAMC,WAAS,EAACC,QAAS,EAAzB,UACE,cAACF,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAf,SACE,cAAC2D,EAAA,EAAD,CACEpR,MAAOiU,GAAgBrL,QAAhB,OAAwBiL,QAAxB,IAAwBA,IAAO,SACtC/O,SAAU,SAACT,EAAOrE,GAAR,OACR8T,EAAQrR,KAAKe,GAAOC,YAAYC,MAAM,CAAEpC,YAAWuS,IAAKI,GAAgBjU,OAE1EqR,eAAe,UACfC,UAAU,UACVC,UAAQ,EACRvP,MAAO,CAAEwO,aAAc,IARzB,SAUGyD,GAAgBzU,KAAI,SAACqU,GAAD,OACnB,cAACrC,EAAA,EAAD,CAAe7M,MAAOkP,GAAZA,UAIhB,cAACvG,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAf,SACE,cAACvK,EAAA,EAAD,UACE,cAAC,GAAD,CACElD,MAAK,iBAAElB,QAAF,IAAEA,OAAF,EAAEA,EAASgF,aAAX,QAAoB,GACzBgB,SAAU,SAAC9E,GAAD,OboIQ,SAChCsB,EACAO,EACA7B,GAEA,OAAO3B,EAAYG,MAAM8C,GAAW9C,MAAMqD,GAAKL,IAAIxB,GazIhBkU,CAAmB5S,EAAW,QAAStB,IAC5DqD,MAAO,OACP6G,UAAW,aAIjB,cAACoD,EAAA,EAAD,CAAM7N,MAAI,EAACgO,GAAI,GAAf,SACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAO0G,KAAM3Q,GAAOC,YAAY2Q,QAAQ,CAAEP,IAAK,UAAYQ,OAAK,EAACrC,UAAWN,KAC5E,cAAC,IAAD,CAAOyC,KAAM3Q,GAAOC,YAAY2Q,QAAQ,CAAEP,IAAK,WAAaQ,OAAK,EAACrC,UAAWyB,KAC7E,cAAC,IAAD,CAAUlQ,GAAIC,GAAOC,YAAY2Q,QAAQ,CAAEP,IAAK,UAAYS,KAAM9Q,GAAOC,YAAY0Q,oBCzD7FI,GAAa,YAUNN,GAAkB,CAAC,QAAS,UAEnCO,GAAiB,6BAOVhR,GAAS,CACpBnB,SAnBe,CACf8R,KAAMI,GACN7Q,MAAO,kBAAc6Q,KAkBrB9Q,YARkB,CAClB0Q,KAAMK,GACN9Q,MAAO,SAAC+Q,GAAD,OAA0CC,YAAaF,GAAmBC,IACjFL,QAAS,gBAAGP,EAAH,EAAGA,IAAH,OAAkEW,GAAkBG,QAAQ,QAASd,MAQnGe,GAAgC,WAC3C,OACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAUrR,GAAIC,GAAOnB,SAAS8R,KAAMG,KAAM,IAAKD,OAAK,IACpD,cAAC,IAAD,CAAOF,KAAM3Q,GAAOnB,SAAS8R,KAAME,OAAK,EAACrC,UAAW5P,IACpD,cAAC,IAAD,CAAO+R,KAAM3Q,GAAOC,YAAY0Q,KAAME,OAAK,EAACrC,UAAW4B,KACvD,cAAC,IAAD,CAAOO,KAAM,OAAQnC,UAAW6C,S,oBChChCC,GAAStI,YAAO,MAAPA,EAAc,qBAAGjC,MAAkBwK,OAAOC,WAsB1CC,GApBmB,SAAC,GAAkB,IAAhBlT,EAAe,EAAfA,SACnC,OACE,mCACE,eAAC0C,EAAA,EAAD,CAAKzC,MAAO,CAAEgJ,cAAe,KAA7B,UACE,cAACkK,GAAA,EAAD,CAAQjH,SAAS,QAAjB,SACE,cAACkH,GAAA,EAAD,UACE,cAAC,EAAD,CAAc5R,GAAI,IAAlB,SACE,cAACL,EAAA,EAAD,CAAY2B,QAAQ,KAAK7C,MAAO,CAAEoT,SAAU,GAA5C,wBAMN,cAACN,GAAD,IACC/S,Q,wCCbHwI,GAAQ8K,aAAY,CACxB9J,QAAS,CACP+J,WAAY,CACVC,QAASC,KAAK,SAkBLvE,GAbgB,WAC7B,OACE,cAAC,IAAD,UACE,cAACwE,GAAA,EAAD,CAAelL,MAAOA,GAAtB,SACE,eAAC,GAAD,WACE,cAACmL,GAAA,EAAD,IACA,cAAC,GAAD,YCjBVC,IAAS/H,OACP,cAAC,IAAMgI,WAAP,UACE,cAAC,GAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.efd83cb8.chunk.js","sourcesContent":["import firebase from 'firebase';\nimport { useEffect, useMemo, useState } from 'react';\nimport currency from 'currency.js';\n\ntype ThenableReference = firebase.database.ThenableReference;\n\nconst config = {\n  apiKey: 'AIzaSyA0c1akMZuNjqCKy8XPOJMkt2gCxhbRTDo',\n  authDomain: 'rece-a5835.firebaseapp.com',\n  projectId: 'rece-a5835',\n  storageBucket: 'rece-a5835.appspot.com',\n  messagingSenderId: '952022605285',\n  appId: '1:952022605285:web:dc6c4ad42eaeb6bf1ae30c',\n  measurementId: 'G-6Z1RJYKRSE',\n};\n\nfirebase.initializeApp(config);\nexport const auth = firebase.auth;\nexport const databaseRef = firebase.database().ref();\nexport const receiptsRef = databaseRef.child('receipts');\n\nexport type ReceiptEntity = {\n  id: string;\n  title: string;\n  total: number;\n  date: number;\n  items?: Record<string, ItemEntity>;\n  people?: Record<string, PersonEntity>;\n  personToItemQuantityMap?: Record<string, Record<string, { quantity: number }>>;\n  itemToPersonQuantityMap?: Record<string, Record<string, { quantity: number }>>;\n  taxCost: number;\n  tipCost: number;\n};\n\nexport type ItemEntity = {\n  id: string;\n  name: string;\n  cost: number;\n  quantity: number;\n};\n\nexport type PersonEntity = {\n  id: string;\n  name: string;\n};\n\nexport const useGetReceipts = (): Array<ReceiptEntity> => {\n  const [data, setData] = useState<Array<ReceiptEntity>>([]);\n\n  useEffect(() => {\n    receiptsRef.on('value', (snapshot) => {\n      const items = snapshot.val();\n      const newState = [];\n      for (const item in items) {\n        newState.push({\n          id: item,\n          ...items[item],\n        });\n      }\n      setData(newState);\n    });\n  }, []);\n\n  return data;\n};\n\nexport type ChargeType = 'taxCost' | 'tipCost';\n\nexport type UseGetReceiptResponse = {\n  receipt?: ReceiptEntity;\n  items: Array<ItemEntity>;\n  people: Array<PersonEntity>;\n  isLoading: boolean;\n  subTotal: number;\n  total: number;\n  setPersonItemQuantity: (personId: string, itemId: string, quantity: number) => Promise<void>;\n  personSubTotalMap: Record<string, number>;\n  getChargeForPerson: (charge: ChargeType, personId: string) => number;\n  getTotalForPerson: (personId: string) => number;\n};\n\nexport const useGetReceipt = (id: string): UseGetReceiptResponse => {\n  const [isLoading, setIsLoading] = useState(true);\n  const [receipt, setReceipt] = useState<ReceiptEntity>();\n\n  useEffect(() => {\n    receiptsRef.child(id).on('value', (snapshot) => {\n      const receipt = snapshot.val();\n      setReceipt({ ...receipt, id });\n      setIsLoading(false);\n    });\n  }, []);\n\n  const items = useMemo<Array<ItemEntity>>(() => {\n    if (!receipt) return [];\n    return Object.entries(receipt.items ?? {}).map(([id, item]) => ({ ...item, id }));\n  }, [receipt]);\n\n  const subTotal = useMemo(() => items.reduce((sum, item) => currency(sum).add(item.cost).value, 0), [items]);\n\n  const people = useMemo<Array<PersonEntity>>(() => {\n    if (!receipt) return [];\n    return Object.entries(receipt.people ?? {}).map(([id, person]) => ({ ...person, id }));\n  }, [receipt]);\n\n  const setPersonItemQuantity = async (personId: string, itemId: string, quantity = 1) => {\n    await receiptsRef\n      .child(id)\n      .child('personToItemQuantityMap')\n      .child(personId)\n      .child(itemId)\n      .update({ quantity: Math.max(quantity, 0) });\n    await receiptsRef\n      .child(id)\n      .child('itemToPersonQuantityMap')\n      .child(itemId)\n      .child(personId)\n      .update({ quantity: Math.max(quantity, 0) });\n  };\n\n  const personSubTotalMap = useMemo<Record<string, number>>(() => {\n    const personSubTotalMap: Record<string, number> = {};\n    if (receipt) {\n      for (const person of people) {\n        personSubTotalMap[person.id] = Object.entries(receipt.personToItemQuantityMap?.[person.id] ?? {}).reduce(\n          (sum, [itemId, { quantity }]) => sum + quantity * (receipt.items?.[itemId]?.cost ?? 0),\n          0,\n        );\n      }\n    }\n    return personSubTotalMap;\n  }, [receipt]);\n\n  const total = useMemo(() => subTotal + (receipt?.tipCost ?? 0) + (receipt?.taxCost ?? 0), [subTotal, receipt]);\n\n  const getChargeForPerson = (charge: ChargeType, personId: string) =>\n    currency(personSubTotalMap[personId])\n      .divide(subTotal > 0 ? subTotal : 1)\n      .multiply(receipt?.[charge] ?? 0).value;\n\n  const getTotalForPerson = (personId: string) =>\n    currency(personSubTotalMap[personId])\n      .add(getChargeForPerson('taxCost', personId))\n      .add(getChargeForPerson('tipCost', personId)).value;\n\n  return {\n    isLoading,\n    receipt,\n    items,\n    subTotal,\n    total,\n    people,\n    setPersonItemQuantity,\n    personSubTotalMap,\n    getChargeForPerson,\n    getTotalForPerson,\n  };\n};\n\nexport const pushReceipt = (receipt: Partial<ReceiptEntity>): ThenableReference => {\n  if (!receipt.date) receipt.date = new Date().getTime();\n  if (!receipt.total) receipt.total = 0;\n  if (!receipt.taxCost) receipt.taxCost = 0;\n  if (!receipt.tipCost) receipt.tipCost = 0;\n  if (!receipt.items) receipt.items = {};\n  if (!receipt.people) receipt.people = {};\n  if (!receipt.personToItemQuantityMap) receipt.personToItemQuantityMap = {};\n  if (!receipt.itemToPersonQuantityMap) receipt.itemToPersonQuantityMap = {};\n\n  return receiptsRef.push(receipt);\n};\n\nexport const updateChargeValue = (receiptId: string, charge: ChargeType, valueString: string): Promise<void> =>\n  receiptsRef.child(receiptId).child(charge).set(currency(valueString).value);\n\nexport const updateChargeValueByPct = (\n  receiptId: string,\n  charge: ChargeType,\n  percentString: string,\n  subTotal: number,\n): Promise<void> => {\n  const value = currency(subTotal).multiply(parseFloat(percentString)).divide(100.0).value;\n  return receiptsRef.child(receiptId).child(charge).set(currency(value).value);\n};\n\nexport const updateReceiptValue = (\n  receiptId: string,\n  key: ChargeType | 'title' | 'total',\n  value: string | number,\n): Promise<void> => {\n  return receiptsRef.child(receiptId).child(key).set(value);\n};\n\nexport const updateReceiptItemValue = (\n  receiptId: string,\n  itemId: string,\n  key: 'name' | 'cost' | 'quantity',\n  value: string | number,\n): Promise<void> => {\n  return receiptsRef.child(receiptId).child('items').child(itemId).child(key).set(value);\n};\n\nexport const getPersonCountForItem = (receipt: ReceiptEntity, itemId: string): number => {\n  if (!receipt || !itemId) return 0;\n  return Object.values(receipt.itemToPersonQuantityMap?.[itemId] ?? {}).reduce(\n    (sum, { quantity }) => sum + quantity,\n    0,\n  );\n};\n\nexport const getItemQuantityForPerson = (receipt: ReceiptEntity, personId: string, itemId: string): number => {\n  if (!receipt || !personId || !itemId) return 0;\n  return ((receipt.personToItemQuantityMap ?? {})[personId] ?? {})[itemId]?.quantity ?? 0;\n};\n","import { Link } from 'react-router-dom';\nimport { ComponentProps, FunctionComponent } from 'react';\n\nconst UnstyledLink: FunctionComponent<ComponentProps<Link>> = ({ children, style, ...otherProps }) => (\n  <Link style={{ color: 'inherit', textDecoration: 'inherit', ...style }} {...otherProps}>\n    {children}\n  </Link>\n);\n\nexport default UnstyledLink;\n","import React, { FormEvent, FunctionComponent, useState } from 'react';\nimport { Box, Button, Container, List, ListItem, Paper, TextField, Typography } from '@material-ui/core';\nimport { pushReceipt, useGetReceipts } from '../functions/firebase';\nimport currency from 'currency.js';\nimport { format } from 'date-fns';\nimport { Routes } from '../core/BaseRouter';\nimport UnstyledLink from '../components/UnstyledLink';\n\nexport const ReceiptsPage: FunctionComponent = () => {\n  const receipts = useGetReceipts();\n\n  return (\n    <Container maxWidth={'md'} sx={{ pt: 2, display: 'flex', flexDirection: 'column', gap: 2 }}>\n      <Typography sx={{ mb: 2 }}>Receipts</Typography>\n      <Paper sx={{ width: '100%' }}>\n        <List>\n          {receipts.map((receipt) => (\n            <UnstyledLink key={receipt.id} to={Routes.receiptInfo.route({ receiptId: receipt.id })}>\n              <ListItem button style={{ width: '100%' }}>\n                <div style={{ width: '100%', display: 'flex', flexDirection: 'column', gap: 10 }}>\n                  <div style={{ display: 'flex' }}>\n                    <Typography style={{ flex: 1 }}>{receipt.title}</Typography>\n                    <Typography>{currency(receipt.total).format()}</Typography>\n                  </div>\n                  <Typography>{format(new Date(receipt.date), 'Pp')}</Typography>\n                </div>\n              </ListItem>\n            </UnstyledLink>\n          ))}\n        </List>\n      </Paper>\n      <NewReceiptForm />\n    </Container>\n  );\n};\n\nconst NewReceiptForm = () => {\n  const [title, setTitle] = useState('');\n\n  const onSubmit = (event: FormEvent) => {\n    event.preventDefault();\n\n    if (!title) return;\n\n    pushReceipt({ title });\n    setTitle('');\n  };\n\n  return (\n    <form onSubmit={onSubmit}>\n      <Box sx={{ display: 'flex' }}>\n        <TextField\n          label={'Receipt Name'}\n          value={title}\n          fullWidth\n          variant={'standard'}\n          onChange={(event) => setTitle(event.target.value)}\n          sx={{ flex: 1 }}\n        />\n        <Button type={'submit'}>Add</Button>\n      </Box>\n    </form>\n  );\n};\n","export const nameToInitials = (name: string): string => {\n  return name\n    .toUpperCase()\n    .split(' ')\n    .map((part) => part.substr(0, 1))\n    .join('');\n};\n\nexport const indexArray = (length: number): number[] => new Array(length).fill(0).map((_, index) => index);\n\nexport const setify = <T>(array: T[]): T[] => [...new Set(array)];\n\nexport const calcPercent = (numerator: number, denominator: number, toFixed = 2): string => {\n  if (isNaN(numerator) || isNaN(denominator) || denominator === 0) return (0).toFixed(2);\n  return ((numerator / denominator) * 100.0).toFixed(toFixed);\n};\n\nexport type Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\nexport type PartialBy<T, K extends keyof T> = Omit<T, K> & Partial<Pick<T, K>>;\n","import { Dispatch, SetStateAction, useState } from 'react';\n\nfunction useLocalStorage<T>(key: string, initialValue: T): [T, Dispatch<SetStateAction<T>>] {\n  // State to store our value\n  // Pass initial state function to useState so logic is only executed once\n  const [storedValue, setStoredValue] = useState<T>(() => {\n    try {\n      // Get from local storage by key\n      const item = window.localStorage.getItem(key);\n      // Parse stored json or if none return initialValue\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      // If error also return initialValue\n      // eslint-disable-next-line no-console\n      console.log(error);\n      return initialValue;\n    }\n  });\n  // Return a wrapped version of useState's setter function that ...\n  // ... persists the new value to localStorage.\n  const setValue = (value: T | ((val: T) => T)) => {\n    try {\n      // Allow value to be a function so we have same API as useState\n      const valueToStore = value instanceof Function ? value(storedValue) : value;\n      // Save state\n      setStoredValue(valueToStore);\n      // Save to local storage\n      window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      // A more advanced implementation would handle the error case\n      // eslint-disable-next-line no-console\n      console.log(error);\n    }\n  };\n  return [storedValue, setValue];\n}\n\nexport default useLocalStorage;\n","import useLocalStorage from './useLocalStorage';\nimport ReceiptItem from '../types/ReceiptItem';\nimport Person from '../types/Person';\nimport { indexArray, setify } from '../functions/utils';\nimport React, { createContext, Dispatch, FunctionComponent, SetStateAction, useContext, useMemo } from 'react';\nimport currency from 'currency.js';\nimport { v4 as uuidv4 } from 'uuid';\n\nexport interface AppDataEntity {\n  items: ReceiptItem[];\n  people: Person[];\n  personToItemsMap: Record<string, string[]>;\n  itemToPeopleMap: Record<string, string[]>;\n  tip: number;\n  tax: number;\n}\n\nconst appDataDefaults = {\n  items: [],\n  people: [],\n  personToItemsMap: {},\n  itemToPeopleMap: {},\n  tip: 0,\n  tax: 0,\n};\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nconst noop = () => {};\n\ninterface AppDataContextProps {\n  appData: AppDataEntity;\n  setAppData: Dispatch<SetStateAction<AppDataEntity>>;\n  reset: () => void;\n  putItem: (newItem: ReceiptItem) => void;\n  removeItem: (itemId: string) => void;\n  splitItem: (itemId: string) => void;\n  putPerson: (newPerson: Person) => void;\n  removePerson: (personId: string) => void;\n  handleSetItemPerson: (itemId: string, personIds: string[], selected: boolean) => void;\n  itemCostMap: Record<string, number>;\n  subTotal: number;\n  total: number;\n  subTotalForPerson: (personId: string) => number;\n  taxForPerson: (personId: string) => number;\n  tipForPerson: (personId: string) => number;\n  totalForPerson: (personId: string) => number;\n}\n\nconst AppDataContext = createContext<AppDataContextProps>({\n  appData: appDataDefaults,\n  setAppData: noop,\n  reset: noop,\n  putItem: noop,\n  removeItem: noop,\n  splitItem: noop,\n  putPerson: noop,\n  removePerson: noop,\n  handleSetItemPerson: noop,\n  itemCostMap: {},\n  subTotal: 0,\n  total: 0,\n  subTotalForPerson: () => 0,\n  taxForPerson: () => 0,\n  tipForPerson: () => 0,\n  totalForPerson: () => 0,\n});\n\nexport const AppDataContextProvider: FunctionComponent = ({ children }) => {\n  const [appData, setAppData] = useLocalStorage<AppDataEntity>('appData', appDataDefaults);\n\n  const reset = () => {\n    setAppData(appDataDefaults);\n  };\n\n  const putItem = (newItem: ReceiptItem) => {\n    setAppData((prev) => {\n      const index = prev.items.map((item) => item.id).indexOf(newItem.id);\n      if (index > -1) {\n        prev.items[index] = newItem;\n        return { ...prev, items: [...prev.items] };\n      } else {\n        return { ...prev, items: [...prev.items, newItem] };\n      }\n    });\n  };\n\n  const removeItem = (itemId: string) => {\n    setAppData((prev) => ({ ...prev, items: prev.items.filter((item) => item.id !== itemId) }));\n  };\n\n  const splitItem = (itemId: string) => {\n    const item = appData.items.find((item) => item.id === itemId);\n    if (!item) return;\n    const splitCount = parseInt(\n      prompt(`How many items should (${item.name} - ${currency(item.cost).format()}) be split into?`) || '',\n    );\n    if (!splitCount || isNaN(splitCount)) return;\n    const newItems: ReceiptItem[] = indexArray(splitCount).map(() => ({\n      id: uuidv4(),\n      name: item.name,\n      cost: item.cost / splitCount,\n    }));\n    setAppData((prev) => ({ ...prev, items: [...prev.items.filter((item) => item.id !== itemId), ...newItems] }));\n  };\n\n  const putPerson = (newPerson: Person) => {\n    setAppData((prev) => {\n      const index = prev.people.map((item) => item.id).indexOf(newPerson.id);\n      if (index > -1) {\n        prev.people[index] = newPerson;\n        return { ...prev, people: [...prev.people] };\n      } else {\n        return { ...prev, people: [...prev.people, newPerson] };\n      }\n    });\n  };\n\n  const removePerson = (personId: string) => {\n    setAppData((prev) => ({ ...prev, people: prev.people.filter((person) => person.id !== personId) }));\n  };\n\n  const handleSetItemPerson = (itemId: string, personIds: string[], selected: boolean) => {\n    setAppData((prev) => {\n      const { personToItemsMap, itemToPeopleMap } = prev;\n      for (const personId of personIds) {\n        if (!personToItemsMap[personId]) personToItemsMap[personId] = [];\n        if (selected) {\n          personToItemsMap[personId] = setify([...personToItemsMap[personId], itemId]);\n        } else {\n          personToItemsMap[personId] = personToItemsMap[personId].filter((_itemId) => _itemId !== itemId);\n        }\n        if (!itemToPeopleMap[itemId]) itemToPeopleMap[itemId] = [];\n        if (selected) {\n          itemToPeopleMap[itemId] = setify([...itemToPeopleMap[itemId], personId]);\n        } else {\n          itemToPeopleMap[itemId] = itemToPeopleMap[itemId].filter((_personId) => _personId !== personId);\n        }\n      }\n      return { ...prev, personToItemsMap, itemToPeopleMap };\n    });\n  };\n\n  const itemCostMap = useMemo<Record<string, number>>(() => {\n    return appData.items.reduce((map, curr) => ({ ...map, [curr.id]: curr.cost }), {});\n  }, [appData.items]);\n\n  const subTotal = useMemo(\n    () =>\n      appData.items.reduce((previousValue, currentValue) => {\n        return currency(previousValue).add(currentValue.cost).value;\n      }, 0.0),\n    [appData.items],\n  );\n\n  const total = currency(subTotal).add(appData.tax).add(appData.tip).value;\n\n  const subTotalForPerson = (personId: string) =>\n    appData.personToItemsMap[personId]?.reduce(\n      (sum, itemId) =>\n        currency(sum).add(currency(itemCostMap[itemId]).divide(appData.itemToPeopleMap[itemId].length)).value,\n      0.0,\n    ) || 0;\n\n  const percentForPerson = (personId: string) => subTotalForPerson(personId) / subTotal;\n\n  const taxForPerson = (personId: string) => currency(appData.tax).multiply(percentForPerson(personId)).value;\n  const tipForPerson = (personId: string) => currency(appData.tip).multiply(percentForPerson(personId)).value;\n\n  const totalForPerson = (personId: string) =>\n    currency(subTotalForPerson(personId)).add(taxForPerson(personId)).add(tipForPerson(personId)).value;\n\n  return (\n    <AppDataContext.Provider\n      value={{\n        appData,\n        setAppData,\n        reset,\n        putItem,\n        removeItem,\n        splitItem,\n        putPerson,\n        removePerson,\n        handleSetItemPerson,\n        itemCostMap,\n        subTotal,\n        total,\n        subTotalForPerson,\n        taxForPerson,\n        tipForPerson,\n        totalForPerson,\n      }}\n    >\n      {children}\n    </AppDataContext.Provider>\n  );\n};\n\nconst useAppData = (): AppDataContextProps => useContext(AppDataContext);\nexport default useAppData;\n","/* eslint-disable @typescript-eslint/no-empty-function */\nimport React, { ReactElement, useEffect, useLayoutEffect, useRef, useState } from 'react';\nimport { Box, ButtonBase, TextField, Typography, useTheme } from '@material-ui/core';\n\nconst EditableField = ({\n  value,\n  onChange = () => {},\n  formatValue = (value) => `${value}`,\n  type,\n  disabled = false,\n  width = 80,\n  textAlign = 'right',\n}: {\n  value: string;\n  onChange?: (value: string) => void;\n  formatValue?: (value: string) => string;\n  type?: React.InputHTMLAttributes<unknown>['type'];\n  disabled?: boolean;\n  width?: number | string;\n  textAlign?: 'left' | 'center' | 'right';\n}): ReactElement => {\n  const [isEditMode, setIsEditMode] = useState(false);\n  const textFieldRef = useRef<HTMLInputElement>();\n  const theme = useTheme();\n\n  const [tempValue, setTempValue] = useState(value);\n\n  useEffect(() => {\n    setTempValue(value);\n  }, [value]);\n\n  useLayoutEffect(() => {\n    if (isEditMode) textFieldRef.current?.focus();\n  }, [isEditMode]);\n\n  const handleFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n    setTempValue(value);\n    setTimeout(() => {\n      event.target.setSelectionRange(0, event.target.value.length);\n    }, 100);\n  };\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const containerProps: any = {\n    paddingTop: '4px',\n    paddingBottom: '1px',\n    display: 'inline-flex',\n    flexDirection: 'column',\n    width,\n  };\n\n  const DisplayTextField = (\n    <Typography align={textAlign} sx={{ width: '100%' }}>\n      {formatValue(value)}\n    </Typography>\n  );\n\n  const Underline = (\n    <Box\n      sx={{\n        marginTop: '2px',\n        height: '1px',\n        width: '100%',\n        backgroundColor: theme.palette.text.disabled,\n        opacity: disabled ? 0 : 1,\n      }}\n    />\n  );\n\n  return isEditMode ? (\n    <TextField\n      value={tempValue}\n      onChange={(event) => setTempValue(event.target.value)}\n      type={type}\n      onBlur={() => setIsEditMode(false)}\n      onFocus={handleFocus}\n      onKeyDown={(event) => {\n        if (['Enter'].includes(event.code)) {\n          setIsEditMode(false);\n          onChange(tempValue);\n        }\n        if (['Escape'].includes(event.code)) {\n          setIsEditMode(false);\n        }\n      }}\n      inputRef={textFieldRef}\n      sx={{ width }}\n      variant={'standard'}\n      inputProps={{ style: { textAlign } }}\n    />\n  ) : disabled ? (\n    <Box sx={containerProps}>\n      {DisplayTextField}\n      {Underline}\n    </Box>\n  ) : (\n    <ButtonBase onClick={() => setIsEditMode(true)} sx={containerProps}>\n      {DisplayTextField}\n      {Underline}\n    </ButtonBase>\n  );\n};\n\nexport default EditableField;\n","import React, { FunctionComponent, KeyboardEvent, useRef } from 'react';\nimport {\n  Avatar,\n  Box,\n  Button,\n  Checkbox,\n  Grid,\n  IconButton,\n  styled,\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n  TextField,\n  Tooltip,\n  Typography,\n  useTheme,\n} from '@material-ui/core';\nimport { Controller, FieldPath, useForm } from 'react-hook-form';\nimport { v4 as uuidv4 } from 'uuid';\nimport currency from 'currency.js';\nimport { nameToInitials } from '../../functions/utils';\nimport useAppData from '../../hooks/useAppData';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport CallSplitIcon from '@material-ui/icons/CallSplit';\nimport EditableField from '../../components/EditableField';\nimport { amber } from '@material-ui/core/colors';\n\ninterface ItemEntryForm {\n  name: string;\n  cost: number;\n}\n\nconst itemEntryFormDefaults: Partial<ItemEntryForm> = {\n  name: '',\n  cost: undefined,\n};\n\nconst getVenmoPaymentLink = ({\n  txn = 'charge',\n  user = '',\n  amount,\n  note = 'Split by Rece',\n}: {\n  txn?: 'pay' | 'charge';\n  user?: string;\n  amount: number;\n  note?: string;\n}) => `venmo://paycharge?txn=${txn}&recipients=${user}&amount=${amount}&note=${note}`;\n\nconst StyledTable = styled(Table)(() => ({\n  backgroundColor: 'white',\n  '& td': {\n    whiteSpace: 'nowrap',\n  },\n}));\n\nconst ItemsTab: FunctionComponent = () => {\n  const {\n    setAppData,\n    appData: { items, people, personToItemsMap, itemToPeopleMap, tax, tip },\n    putItem,\n    removeItem,\n    splitItem,\n    handleSetItemPerson,\n    subTotal,\n    subTotalForPerson,\n    total,\n    taxForPerson,\n    tipForPerson,\n    totalForPerson,\n  } = useAppData();\n\n  const { reset: resetAll } = useAppData();\n\n  const handleReset = () => {\n    if (confirm(\"Are you sure you'd like to reset?\")) resetAll();\n  };\n\n  const { control, handleSubmit, reset } = useForm<ItemEntryForm>({ defaultValues: itemEntryFormDefaults });\n\n  const nameFieldRef = useRef<HTMLInputElement | null>(null);\n  const costFieldRef = useRef<HTMLInputElement | null>(null);\n\n  const handleOnSubmit = ({ name, cost }: ItemEntryForm) => {\n    const newItem = {\n      id: uuidv4(),\n      name,\n      cost,\n    };\n    putItem(newItem);\n    reset(itemEntryFormDefaults);\n    nameFieldRef.current?.focus();\n  };\n\n  const handleOnKeyDown = (name: FieldPath<ItemEntryForm>) => (event: KeyboardEvent<HTMLInputElement>) => {\n    if (event.code === 'Enter') {\n      if (name === 'name') {\n        costFieldRef.current?.focus();\n      } else if (name === 'cost') {\n        handleSubmit(handleOnSubmit)(event);\n      }\n    }\n  };\n\n  const theme = useTheme();\n\n  return (\n    <>\n      <Button onClick={handleReset} style={{ color: 'inherit' }}>\n        Reset\n      </Button>\n      <Typography>Enter Receipt Items</Typography>\n      <Grid container spacing={4}>\n        <Grid item xs={12}>\n          <form onSubmit={handleSubmit(handleOnSubmit)}>\n            <Grid container spacing={2} alignItems={'flex-end'}>\n              <Grid item xs={12} md={6}>\n                <Controller\n                  control={control}\n                  name={'name'}\n                  render={({ field }) => (\n                    <TextField\n                      {...field}\n                      inputRef={(ref) => {\n                        nameFieldRef.current = ref;\n                        field.ref(ref);\n                      }}\n                      label=\"Item Name\"\n                      fullWidth\n                      onKeyDown={handleOnKeyDown('name')}\n                    />\n                  )}\n                />\n              </Grid>\n              <Grid item xs={12} md={5}>\n                <Controller\n                  control={control}\n                  name={'cost'}\n                  render={({ field }) => (\n                    <TextField\n                      {...field}\n                      inputRef={(ref) => {\n                        costFieldRef.current = ref;\n                        field.ref(ref);\n                      }}\n                      label=\"Cost\"\n                      fullWidth\n                      onKeyDown={handleOnKeyDown('cost')}\n                      type={'number'}\n                    />\n                  )}\n                  rules={{ required: true }}\n                />\n              </Grid>\n              <Grid item xs={12} md={1}>\n                <Button variant={'contained'} color={'primary'} fullWidth type={'submit'}>\n                  Add\n                </Button>\n              </Grid>\n            </Grid>\n          </form>\n        </Grid>\n        <Grid item xs={12}>\n          <Box style={{ overflow: 'auto', position: 'relative' }}>\n            <StyledTable>\n              <TableHead>\n                <TableRow>\n                  <TableCell\n                    style={{ position: 'sticky', left: 0, backgroundColor: 'white', zIndex: 100, minWidth: 100 }}\n                  >\n                    Name\n                  </TableCell>\n                  <TableCell style={{ minWidth: 200 }}>Cost</TableCell>\n                  <TableCell style={{ width: 1 }} />\n                  {people.map((person) => (\n                    <TableCell key={person.id} style={{ width: 1 }}>\n                      <Tooltip title={person.name}>\n                        <Avatar style={{ height: 24, width: 24, fontSize: 12 }}>{nameToInitials(person.name)}</Avatar>\n                      </Tooltip>\n                    </TableCell>\n                  ))}\n                  <TableCell />\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {items.map((item) => (\n                  <TableRow\n                    key={item.id}\n                    style={{\n                      backgroundColor: (itemToPeopleMap[item.id]?.length || 0) === 0 ? amber[100] : 'white',\n                    }}\n                  >\n                    <TableCell\n                      style={{\n                        position: 'sticky',\n                        left: 0,\n                        zIndex: 100,\n                        backgroundColor: (itemToPeopleMap[item.id]?.length || 0) === 0 ? amber[100] : 'white',\n                      }}\n                    >\n                      <EditableField value={item.name} onChange={(name) => putItem({ ...item, name })} />\n                    </TableCell>\n                    <TableCell>\n                      <EditableField\n                        type={'number'}\n                        value={String(item.cost)}\n                        onChange={(value) => putItem({ ...item, cost: parseFloat(value) })}\n                        formatValue={(value) => currency(value).format()}\n                      />\n                    </TableCell>\n                    <TableCell>\n                      <Box style={{ display: 'flex' }}>\n                        <IconButton\n                          size={'small'}\n                          edge=\"end\"\n                          onClick={() => splitItem(item.id)}\n                          style={{ marginRight: theme.spacing(1) }}\n                        >\n                          <CallSplitIcon color={'primary'} />\n                        </IconButton>\n                        <IconButton\n                          size={'small'}\n                          edge=\"end\"\n                          onClick={() => {\n                            if (confirm(\"Are you sure you'd like to remove this item?\")) removeItem(item.id);\n                          }}\n                        >\n                          <DeleteIcon color={'error'} />\n                        </IconButton>\n                      </Box>\n                    </TableCell>\n                    {people.map((person) => (\n                      <TableCell key={person.id}>\n                        <Checkbox\n                          checked={personToItemsMap[person.id]?.includes(item.id) || false}\n                          onChange={(event) => handleSetItemPerson(item.id, [person.id], event.target.checked)}\n                        />\n                      </TableCell>\n                    ))}\n                    <TableCell style={{ width: 1 }}>\n                      <Button\n                        onClick={() =>\n                          handleSetItemPerson(\n                            item.id,\n                            people.map((person) => person.id),\n                            !personToItemsMap[people[0].id]?.includes(item.id),\n                          )\n                        }\n                      >\n                        All\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n                {/* SubTotal Row */}\n                <TableRow>\n                  <TableCell\n                    style={{\n                      position: 'sticky',\n                      left: 0,\n                      backgroundColor: 'white',\n                      zIndex: 100,\n                      whiteSpace: 'nowrap',\n                    }}\n                  >\n                    <Typography>Subtotal</Typography>\n                  </TableCell>\n                  <TableCell>\n                    <Typography>{currency(subTotal).format()}</Typography>\n                  </TableCell>\n                  <TableCell />\n                  {people.map((person) => (\n                    <TableCell key={person.id}>\n                      <Typography>{currency(subTotalForPerson(person.id)).format()}</Typography>\n                    </TableCell>\n                  ))}\n                  <TableCell />\n                </TableRow>\n                {/* Tax Row */}\n                <TableRow\n                  style={{\n                    backgroundColor: tax === 0 ? amber[100] : undefined,\n                  }}\n                >\n                  <TableCell\n                    style={{\n                      position: 'sticky',\n                      left: 0,\n                      zIndex: 100,\n                      whiteSpace: 'nowrap',\n                      backgroundColor: tax === 0 ? amber[100] : 'white',\n                    }}\n                  >\n                    <Box\n                      style={{\n                        display: 'flex',\n                        alignItems: 'center',\n                      }}\n                    >\n                      <Typography style={{ marginRight: 10 }}>Tax</Typography>\n                      <EditableField\n                        type={'number'}\n                        value={String(subTotal > 0 ? tax / subTotal : 0)}\n                        onChange={(taxPct) =>\n                          setAppData((prev) => ({ ...prev, tax: subTotal * (parseFloat(taxPct) / 100.0) }))\n                        }\n                        formatValue={(value) => `${(parseFloat(value) * 100).toFixed(2)}%`}\n                      />\n                    </Box>\n                  </TableCell>\n                  <TableCell>\n                    <EditableField\n                      type={'number'}\n                      value={String(tax)}\n                      onChange={(tax) => setAppData((prev) => ({ ...prev, tax: parseFloat(tax) }))}\n                      formatValue={(value) => currency(value).format()}\n                    />\n                  </TableCell>\n                  <TableCell />\n                  {people.map((person) => (\n                    <TableCell key={person.id}>\n                      <Typography>{currency(taxForPerson(person.id)).format()}</Typography>\n                    </TableCell>\n                  ))}\n                  <TableCell />\n                </TableRow>\n                {/* Tip Row */}\n                <TableRow\n                  style={{\n                    backgroundColor: tip === 0 ? amber[100] : undefined,\n                  }}\n                >\n                  <TableCell\n                    style={{\n                      position: 'sticky',\n                      left: 0,\n                      backgroundColor: tip === 0 ? amber[100] : 'white',\n                      zIndex: 100,\n                      whiteSpace: 'nowrap',\n                    }}\n                  >\n                    <Box\n                      style={{\n                        display: 'flex',\n                        alignItems: 'center',\n                      }}\n                    >\n                      <Typography style={{ marginRight: 10 }}>Tip</Typography>\n                      <EditableField\n                        type={'number'}\n                        value={String(subTotal > 0 ? tip / subTotal : 0)}\n                        onChange={(tipPct) =>\n                          setAppData((prev) => ({ ...prev, tip: subTotal * (parseFloat(tipPct) / 100.0) }))\n                        }\n                        formatValue={(value) => `${(parseFloat(value) * 100).toFixed(2)}%`}\n                      />\n                    </Box>\n                  </TableCell>\n                  <TableCell>\n                    <EditableField\n                      type={'number'}\n                      value={String(tip)}\n                      onChange={(tip) => setAppData((prev) => ({ ...prev, tip: parseFloat(tip) }))}\n                      formatValue={(value) => currency(value).format()}\n                    />\n                  </TableCell>\n                  <TableCell />\n                  {people.map((person) => (\n                    <TableCell key={person.id}>\n                      <Typography>{currency(tipForPerson(person.id)).format()}</Typography>\n                    </TableCell>\n                  ))}\n                  <TableCell />\n                </TableRow>\n                {/* Total Row */}\n                <TableRow>\n                  <TableCell\n                    style={{\n                      position: 'sticky',\n                      left: 0,\n                      backgroundColor: 'white',\n                      zIndex: 100,\n                      whiteSpace: 'nowrap',\n                    }}\n                  >\n                    <Typography>Total</Typography>\n                  </TableCell>\n                  <TableCell style={{ paddingTop: 0, paddingBottom: 0 }}>\n                    <Typography>{currency(total).format()}</Typography>\n                  </TableCell>\n                  <TableCell />\n                  {people.map((person) => (\n                    <TableCell key={person.id} style={{ paddingTop: 0, paddingBottom: 0 }}>\n                      <Typography\n                        onClick={() => {\n                          window.location.href = getVenmoPaymentLink({ amount: totalForPerson(person.id) });\n                        }}\n                      >\n                        {currency(totalForPerson(person.id)).format()}\n                      </Typography>\n                    </TableCell>\n                  ))}\n                  <TableCell />\n                </TableRow>\n              </TableBody>\n            </StyledTable>\n          </Box>\n        </Grid>\n      </Grid>\n    </>\n  );\n};\n\nexport default ItemsTab;\n","import React, { FunctionComponent, KeyboardEvent, useState } from 'react';\nimport {\n  Avatar,\n  Button,\n  Grid,\n  IconButton,\n  List,\n  ListItem,\n  ListItemAvatar,\n  ListItemSecondaryAction,\n  TextField,\n  Typography,\n} from '@material-ui/core';\nimport { v4 as uuidv4 } from 'uuid';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { nameToInitials } from '../../functions/utils';\nimport useAppData from '../../hooks/useAppData';\nimport EditableField from '../../components/EditableField';\n\nconst PeopleTab: FunctionComponent = () => {\n  const {\n    appData: { people },\n    putPerson,\n    removePerson,\n  } = useAppData();\n\n  const [personNameInput, setPersonNameInput] = useState('');\n\n  const handleAddPerson = (name: string) => {\n    if (!name) return;\n    putPerson({ id: uuidv4(), name: name.trim() });\n    setPersonNameInput('');\n  };\n\n  const handleOnKeyDown = (event: KeyboardEvent<HTMLInputElement>) => {\n    if (event.code === 'Enter') {\n      handleAddPerson(personNameInput);\n    }\n  };\n\n  return (\n    <>\n      <Typography>Enter People</Typography>\n      <Grid container spacing={4}>\n        <Grid item xs={12}>\n          <Grid container spacing={2} alignItems={'flex-end'}>\n            <Grid item xs={12} md={11}>\n              <TextField\n                value={personNameInput}\n                onChange={(event) => setPersonNameInput(event.target.value)}\n                label=\"Person Name\"\n                fullWidth\n                onKeyDown={handleOnKeyDown}\n              />\n            </Grid>\n            <Grid item xs={12} md={1}>\n              <Button\n                variant={'contained'}\n                color={'primary'}\n                onClick={() => handleAddPerson(personNameInput)}\n                fullWidth\n              >\n                Add\n              </Button>\n            </Grid>\n          </Grid>\n        </Grid>\n        <Grid item xs={12}>\n          <List>\n            {people.map((person) => (\n              <ListItem key={person.id}>\n                <ListItemAvatar>\n                  <Avatar>{nameToInitials(person.name)}</Avatar>\n                </ListItemAvatar>\n                <EditableField value={person.name} onChange={(name) => putPerson({ ...person, name })} />\n                <ListItemSecondaryAction>\n                  <IconButton edge=\"end\" onClick={() => removePerson(person.id)}>\n                    <DeleteIcon />\n                  </IconButton>\n                </ListItemSecondaryAction>\n              </ListItem>\n            ))}\n          </List>\n        </Grid>\n      </Grid>\n    </>\n  );\n};\n\nexport default PeopleTab;\n","import React, { FunctionComponent, useState } from 'react';\nimport useAppData from '../hooks/useAppData';\nimport { Box, Button, Card, CardContent, Collapse, Container, Typography } from '@material-ui/core';\nimport currency from 'currency.js';\n\nexport const DebugView: FunctionComponent = () => {\n  const [showDebugView, setShowDebugView] = useState(false);\n\n  const { appData, subTotalForPerson, taxForPerson, tipForPerson, totalForPerson, subTotal, total } = useAppData();\n\n  return (\n    <Box style={{ marginBottom: 50 }}>\n      <Container>\n        <Card>\n          <Button onClick={() => setShowDebugView((prev) => !prev)}>Debug</Button>\n          <Collapse in={showDebugView}>\n            <CardContent>\n              <UncontrolledCollapse buttonTitle={'appData'}>\n                <pre>{JSON.stringify(appData, null, 2)}</pre>\n              </UncontrolledCollapse>\n              <UncontrolledCollapse buttonTitle={'Real Sums'}>\n                <div>\n                  <Typography>Sub Total ({currency(subTotal).format()})</Typography>\n                  {appData.people.map((person) => (\n                    <div key={person.id}>\n                      {person.name} - {currency(subTotalForPerson(person.id)).format()}\n                    </div>\n                  ))}\n                  <div>\n                    Sum -{' '}\n                    {appData.people\n                      .reduce((sum, person) => sum.add(subTotalForPerson(person.id)), currency(0))\n                      .format()}\n                  </div>\n                </div>\n                <div>\n                  <Typography>Tax ({currency(appData.tax).format()})</Typography>\n                  {appData.people.map((person) => (\n                    <div key={person.id}>\n                      {person.name} - {currency(taxForPerson(person.id)).format()}\n                    </div>\n                  ))}\n                  <div>\n                    Sum -{' '}\n                    {appData.people.reduce((sum, person) => sum.add(taxForPerson(person.id)), currency(0)).format()}\n                  </div>\n                </div>\n                <div>\n                  <Typography>Tip ({currency(appData.tip).format()})</Typography>\n                  {appData.people.map((person) => (\n                    <div key={person.id}>\n                      {person.name} - {currency(tipForPerson(person.id)).format()}\n                    </div>\n                  ))}\n                  <div>\n                    Sum -{' '}\n                    {appData.people.reduce((sum, person) => sum.add(tipForPerson(person.id)), currency(0)).format()}\n                  </div>\n                </div>\n                <div>\n                  <Typography>Total ({currency(total).format()})</Typography>\n                  {appData.people.map((person) => (\n                    <div key={person.id}>\n                      {person.name} - {currency(totalForPerson(person.id)).format()}\n                    </div>\n                  ))}\n                  <div>\n                    Sum -{' '}\n                    {appData.people.reduce((sum, person) => sum.add(totalForPerson(person.id)), currency(0)).format()}\n                  </div>\n                </div>\n              </UncontrolledCollapse>\n            </CardContent>\n          </Collapse>\n        </Card>\n      </Container>\n    </Box>\n  );\n};\n\nconst UncontrolledCollapse: FunctionComponent<{ buttonTitle: string }> = ({ children, buttonTitle }) => {\n  const [open, setOpen] = useState(false);\n\n  return (\n    <>\n      <Button onClick={() => setOpen((prev) => !prev)}>{buttonTitle}</Button>\n      <Collapse in={open}>{children}</Collapse>\n    </>\n  );\n};\n","import React, { FunctionComponent, useState } from 'react';\nimport { Container, Tab, Tabs } from '@material-ui/core';\nimport ItemsTab from './ItemsTab';\nimport PeopleTab from './PeopleTab';\nimport { AppDataContextProvider } from '../../hooks/useAppData';\nimport { DebugView } from '../../components/DebugView';\n\nconst App: FunctionComponent = () => {\n  const [currentTab, setCurrentTab] = useState(0);\n\n  return (\n    <div>\n      <AppDataContextProvider>\n        <Container>\n          <Tabs\n            value={currentTab}\n            onChange={(event, value) => setCurrentTab(value)}\n            indicatorColor=\"primary\"\n            textColor=\"primary\"\n            centered\n            style={{ marginBottom: 20 }}\n          >\n            <Tab label=\"Items\" />\n            <Tab label=\"People\" />\n          </Tabs>\n          {currentTab === 0 && <ItemsTab />}\n          {currentTab === 1 && <PeopleTab />}\n        </Container>\n        <DebugView />\n      </AppDataContextProvider>\n    </div>\n  );\n};\n\nexport default App;\n","import React, { FunctionComponent, useCallback, useRef } from 'react';\nimport { useParams } from 'react-router';\nimport { ReceiptInfoPathProps } from '../core/BaseRouter';\nimport {\n  Avatar,\n  Box,\n  Button,\n  Grid,\n  IconButton,\n  Paper,\n  styled,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  TextField,\n  Tooltip,\n  Typography,\n} from '@material-ui/core';\nimport {\n  getItemQuantityForPerson,\n  getPersonCountForItem,\n  ReceiptEntity,\n  receiptsRef,\n  updateChargeValue,\n  updateChargeValueByPct,\n  updateReceiptItemValue,\n  useGetReceipt,\n} from '../functions/firebase';\nimport { Controller, FieldPath, useForm } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport currency from 'currency.js';\nimport * as yup from 'yup';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { nameToInitials } from '../functions/utils';\nimport RemoveIcon from '@material-ui/icons/Remove';\nimport AddIcon from '@material-ui/icons/Add';\nimport EditableField from '../components/EditableField';\nimport { amber } from '@material-ui/core/colors';\n\nconst StyledTable = styled(Table)(() => ({\n  backgroundColor: 'white',\n  '& td': {\n    whiteSpace: 'nowrap',\n    paddingTop: '8px',\n    paddingBottom: '8px',\n  },\n}));\n\nconst warningBgColor = amber[100];\n\nconst ReceiptItemsTab: FunctionComponent = () => {\n  const { receiptId } = useParams<ReceiptInfoPathProps>();\n\n  const {\n    receipt,\n    items,\n    subTotal,\n    total,\n    people,\n    setPersonItemQuantity,\n    personSubTotalMap,\n    getChargeForPerson,\n    getTotalForPerson,\n  } = useGetReceipt(receiptId);\n\n  const ItemsTable: FunctionComponent = useCallback(() => {\n    const removeItem = async (itemId: string) => {\n      if (!confirm(\"Are you sure you'd like to remove this item?\")) return;\n      if (!receipt || !itemId) return;\n      await receiptsRef.child(receipt.id).child('items').child(itemId).remove();\n    };\n\n    if (!receipt) return <></>;\n\n    return (\n      <TableContainer component={Paper}>\n        <StyledTable>\n          <TableHead>\n            <TableRow>\n              <TableCell />\n              <TableCell sx={{ width: '1%' }} align=\"right\">\n                Quantity\n              </TableCell>\n              <TableCell align=\"right\" sx={{ width: '1%' }}>\n                Cost\n              </TableCell>\n              {people.map((person) => (\n                <TableCell key={person.id} sx={{ width: '1%' }}>\n                  <Box sx={{ display: 'flex', justifyContent: 'center' }}>\n                    <Tooltip title={person.name}>\n                      <Avatar style={{ height: 24, width: 24, fontSize: 12 }}>{nameToInitials(person.name)}</Avatar>\n                    </Tooltip>\n                  </Box>\n                </TableCell>\n              ))}\n              <TableCell sx={{ width: '1%' }} />\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {items.length === 0 ? (\n              <TableRow>\n                <TableCell align={'center'} colSpan={4 + people.length}>\n                  There are no items yet.\n                </TableCell>\n              </TableRow>\n            ) : (\n              items.map((item) => {\n                const isItemFull = getPersonCountForItem(receipt, item.id) >= item.quantity;\n\n                return (\n                  <TableRow key={item.id}>\n                    <TableCell>\n                      <EditableField\n                        value={item.name}\n                        onChange={(value) => updateReceiptItemValue(receiptId, item.id, 'name', value)}\n                        textAlign={'left'}\n                      />\n                    </TableCell>\n                    <TableCell align={'right'}>\n                      <EditableField\n                        value={String(item.quantity)}\n                        onChange={(value) =>\n                          updateReceiptItemValue(receiptId, item.id, 'quantity', Math.max(1, parseInt(value)))\n                        }\n                      />\n                    </TableCell>\n                    <TableCell align={'right'}>\n                      <EditableField\n                        value={currency(item.cost).format()}\n                        onChange={(value) => updateReceiptItemValue(receiptId, item.id, 'cost', currency(value).value)}\n                      />\n                    </TableCell>\n                    {people.map((person) => {\n                      const personItemQuantity = getItemQuantityForPerson(receipt, person.id, item.id);\n\n                      return (\n                        <TableCell\n                          key={person.id}\n                          sx={{\n                            width: '1%',\n                            backgroundColor: !isItemFull ? warningBgColor : undefined,\n                          }}\n                          align={'center'}\n                        >\n                          <Box sx={{ display: 'inline-flex', justifyContent: 'center', alignItems: 'center' }}>\n                            <IconButton\n                              size={'small'}\n                              onClick={() => setPersonItemQuantity(person.id, item.id, personItemQuantity - 1)}\n                              disabled={personItemQuantity <= 0}\n                            >\n                              <RemoveIcon />\n                            </IconButton>\n                            <Typography>{JSON.stringify(personItemQuantity)}</Typography>\n                            <IconButton\n                              size={'small'}\n                              onClick={() => setPersonItemQuantity(person.id, item.id, personItemQuantity + 1)}\n                              disabled={isItemFull}\n                            >\n                              <AddIcon />\n                            </IconButton>\n                          </Box>\n                        </TableCell>\n                      );\n                    })}\n                    <TableCell align=\"right\">\n                      <IconButton size={'small'} edge=\"end\" onClick={() => removeItem(item.id)}>\n                        <DeleteIcon color={'error'} />\n                      </IconButton>\n                    </TableCell>\n                  </TableRow>\n                );\n              })\n            )}\n            <TableRow sx={{ height: 30, backgroundColor: 'background.default' }} />\n            <TableRow>\n              <TableCell>Sub Total</TableCell>\n              <TableCell />\n              <TableCell align={'right'}>\n                <EditableField value={currency(subTotal).format()} disabled />\n              </TableCell>\n              {people.map((person) => (\n                <TableCell key={person.id}>\n                  <EditableField value={currency(personSubTotalMap[person.id]).format()} disabled />\n                </TableCell>\n              ))}\n              <TableCell />\n            </TableRow>\n            <TableRow>\n              <TableCell>Tax</TableCell>\n              <TableCell align={'right'}>\n                <EditableField\n                  value={String(\n                    ((currency(receipt.taxCost).value / currency(subTotal > 0 ? subTotal : 1).value) * 100.0).toFixed(\n                      3,\n                    ),\n                  )}\n                  formatValue={(val) => `${val}%`}\n                  onChange={(percent) => updateChargeValueByPct(receiptId, 'taxCost', percent, subTotal)}\n                />\n              </TableCell>\n              <TableCell align={'right'}>\n                <EditableField\n                  value={currency(receipt.taxCost).format()}\n                  onChange={(value) => updateChargeValue(receiptId, 'taxCost', value)}\n                />\n              </TableCell>\n              {people.map((person) => (\n                <TableCell key={person.id}>\n                  <EditableField value={currency(getChargeForPerson('taxCost', person.id)).format()} disabled />\n                </TableCell>\n              ))}\n              <TableCell />\n            </TableRow>\n            <TableRow>\n              <TableCell>Tip</TableCell>\n              <TableCell align={'right'}>\n                <EditableField\n                  value={String(\n                    ((currency(receipt.tipCost).value / currency(subTotal > 0 ? subTotal : 1).value) * 100.0).toFixed(\n                      3,\n                    ),\n                  )}\n                  formatValue={(val) => `${val}%`}\n                  onChange={(percent) => updateChargeValueByPct(receiptId, 'tipCost', percent, subTotal)}\n                />\n              </TableCell>\n              <TableCell align={'right'}>\n                <EditableField\n                  value={currency(receipt.tipCost).format()}\n                  onChange={(value) => updateChargeValue(receiptId, 'tipCost', value)}\n                />\n              </TableCell>\n              {people.map((person) => (\n                <TableCell key={person.id}>\n                  <EditableField value={currency(getChargeForPerson('tipCost', person.id)).format()} disabled />\n                </TableCell>\n              ))}\n              <TableCell />\n            </TableRow>\n            <TableRow>\n              <TableCell />\n              <TableCell />\n              <TableCell />\n              {people.map((person) => (\n                <TableCell key={person.id}>\n                  <Box sx={{ display: 'flex', justifyContent: 'center' }}>\n                    <Tooltip title={person.name}>\n                      <Avatar style={{ height: 24, width: 24, fontSize: 12 }}>{nameToInitials(person.name)}</Avatar>\n                    </Tooltip>\n                  </Box>\n                </TableCell>\n              ))}\n              <TableCell />\n            </TableRow>\n            <TableRow>\n              <TableCell>Total</TableCell>\n              <TableCell />\n              <TableCell align={'right'}>\n                <EditableField value={currency(total).format()} disabled />\n              </TableCell>\n              {people.map((person) => (\n                <TableCell key={person.id}>\n                  <EditableField value={currency(getTotalForPerson(person.id)).format()} disabled />\n                </TableCell>\n              ))}\n              <TableCell />\n            </TableRow>\n          </TableBody>\n        </StyledTable>\n      </TableContainer>\n    );\n  }, [items]);\n\n  return (\n    <>\n      {receipt && (\n        <Grid container spacing={2}>\n          <Grid item xs={12}>\n            <AddItemForm receipt={receipt} />\n          </Grid>\n          <Grid item xs={12}>\n            <ItemsTable />\n          </Grid>\n        </Grid>\n      )}\n    </>\n  );\n};\n\nexport default ReceiptItemsTab;\n\ntype AddItemFormProps = {\n  name: string;\n  cost: number;\n  quantity: number;\n};\n\nconst addItemFormDefaults: Partial<AddItemFormProps> = {\n  name: '',\n  cost: 0,\n  quantity: 1,\n};\n\nconst addItemFormValidation = yup.object().shape({\n  name: yup.string().required(),\n  cost: yup.number().positive().required(),\n  quantity: yup.number().integer().positive().required(),\n});\n\nconst AddItemForm: FunctionComponent<{ receipt: ReceiptEntity }> = ({ receipt }) => {\n  const { control, handleSubmit, reset } = useForm<AddItemFormProps>({\n    defaultValues: addItemFormDefaults,\n    resolver: yupResolver(addItemFormValidation),\n  });\n\n  const nameFieldRef = useRef<HTMLInputElement | null>(null);\n  const costFieldRef = useRef<HTMLInputElement | null>(null);\n  const quantityFieldRef = useRef<HTMLInputElement | null>(null);\n\n  const onSubmit = async (form: AddItemFormProps) => {\n    receiptsRef.child(receipt.id).child('items').push(form);\n    reset(addItemFormDefaults);\n    nameFieldRef.current?.focus();\n  };\n\n  const handleOnKeyDown = (name: FieldPath<AddItemFormProps>) => (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.code === 'Enter') {\n      if (name === 'name' && !!costFieldRef.current?.value) {\n        costFieldRef.current?.focus();\n      } else if (name === 'cost' || name === 'quantity') {\n        handleSubmit(onSubmit)(event);\n      }\n    }\n  };\n\n  const handleFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n    setTimeout(() => {\n      event.target.setSelectionRange(0, event.target.value.length);\n    }, 100);\n  };\n\n  return (\n    <Paper sx={{ p: 1 }}>\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <Grid container spacing={2} alignItems={'flex-end'}>\n          <Grid item xs={12} md={6}>\n            <Controller\n              control={control}\n              name={'name'}\n              render={({ field }) => (\n                <TextField\n                  {...field}\n                  inputRef={(ref) => {\n                    nameFieldRef.current = ref;\n                    field.ref(ref);\n                  }}\n                  variant={'standard'}\n                  label=\"Item Name\"\n                  fullWidth\n                  onKeyDown={handleOnKeyDown('name')}\n                  onFocus={handleFocus}\n                />\n              )}\n            />\n          </Grid>\n          <Grid item xs={12} sm={8} md={3}>\n            <Controller\n              control={control}\n              name={'cost'}\n              render={({ field }) => (\n                <TextField\n                  {...field}\n                  inputRef={(ref) => {\n                    costFieldRef.current = ref;\n                    field.ref(ref);\n                  }}\n                  variant={'standard'}\n                  label=\"Cost\"\n                  fullWidth\n                  onKeyDown={handleOnKeyDown('cost')}\n                  onFocus={handleFocus}\n                  type={'number'}\n                  inputProps={{ step: 'any', min: 0 }}\n                />\n              )}\n              rules={{ required: true }}\n            />\n          </Grid>\n          <Grid item xs={12} sm={4} md={2}>\n            <Controller\n              control={control}\n              name={'quantity'}\n              render={({ field }) => (\n                <TextField\n                  {...field}\n                  inputRef={(ref) => {\n                    quantityFieldRef.current = ref;\n                    field.ref(ref);\n                  }}\n                  variant={'standard'}\n                  label=\"Quantity\"\n                  fullWidth\n                  onKeyDown={handleOnKeyDown('quantity')}\n                  onFocus={handleFocus}\n                  type={'number'}\n                  inputProps={{ min: 0 }}\n                />\n              )}\n              rules={{ required: true }}\n            />\n          </Grid>\n          <Grid item xs={12} md={1}>\n            <Button variant={'contained'} color={'primary'} fullWidth type={'submit'}>\n              Add\n            </Button>\n          </Grid>\n        </Grid>\n      </form>\n    </Paper>\n  );\n};\n","import React, { FunctionComponent, useRef } from 'react';\nimport { receiptsRef, useGetReceipt } from '../functions/firebase';\nimport { useParams } from 'react-router';\nimport { ReceiptInfoPathProps } from '../core/BaseRouter';\nimport {\n  Avatar,\n  Box,\n  Button,\n  Divider,\n  IconButton,\n  List,\n  ListItem,\n  ListItemAvatar,\n  Paper,\n  TextField,\n  Typography,\n} from '@material-ui/core';\nimport { Controller, useForm } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as yup from 'yup';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { nameToInitials } from '../functions/utils';\nimport EditableField from '../components/EditableField';\n\ntype AddPersonFormProps = { name: string };\n\nconst ReceiptPeopleTab: FunctionComponent = () => {\n  const { receiptId } = useParams<ReceiptInfoPathProps>();\n\n  const { receipt, people } = useGetReceipt(receiptId);\n\n  const { control, handleSubmit, reset } = useForm<AddPersonFormProps>({\n    resolver: yupResolver(\n      yup.object().shape({\n        name: yup.string().required(),\n      }),\n    ),\n  });\n\n  const nameFieldRef = useRef<HTMLInputElement | null>(null);\n\n  const onSubmit = (form: AddPersonFormProps) => {\n    if (!receipt) return;\n    receiptsRef.child(receipt.id).child('people').push(form);\n    reset({ name: '' });\n  };\n\n  const handleOnKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.code === 'Enter') {\n      handleSubmit(onSubmit)(event);\n    }\n  };\n\n  const handleFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n    setTimeout(() => {\n      event.target.setSelectionRange(0, event.target.value.length);\n    }, 100);\n  };\n\n  const removePerson = async (personId: string) => {\n    if (!confirm(\"Are you sure you'd like to remove this person?\")) return;\n    if (!receipt || !personId) return;\n    await receiptsRef.child(receipt.id).child('people').child(personId).remove();\n  };\n\n  return (\n    <>\n      <Typography variant={'h3'} sx={{ mb: 2 }}>\n        People\n      </Typography>\n      <Paper>\n        <List>\n          {people.map((person) => (\n            <ListItem key={person.id}>\n              <Box sx={{ display: 'flex', alignItems: 'center', width: '100%', gap: 2 }}>\n                <ListItemAvatar>\n                  <Avatar>{nameToInitials(person.name)}</Avatar>\n                </ListItemAvatar>\n                <EditableField value={person.name} width={'100%'} textAlign={'left'} />\n                <IconButton size={'small'} edge=\"end\" onClick={() => removePerson(person.id)}>\n                  <DeleteIcon color={'error'} />\n                </IconButton>\n              </Box>\n            </ListItem>\n          ))}\n          {people?.length > 0 && <Divider sx={{ mt: 2, mb: 2 }} />}\n          <form onSubmit={handleSubmit(onSubmit)}>\n            <ListItem>\n              <Box sx={{ width: '100%', display: 'flex', gap: '16px' }}>\n                <Controller\n                  control={control}\n                  name={'name'}\n                  render={({ field }) => (\n                    <TextField\n                      {...field}\n                      inputRef={(ref) => {\n                        nameFieldRef.current = ref;\n                        field.ref(ref);\n                      }}\n                      variant={'standard'}\n                      label=\"Person Name\"\n                      fullWidth\n                      onKeyDown={handleOnKeyDown}\n                      onFocus={handleFocus}\n                      sx={{ flex: 1 }}\n                    />\n                  )}\n                />\n                <Button type={'submit'}>Add</Button>\n              </Box>\n            </ListItem>\n          </form>\n        </List>\n      </Paper>\n    </>\n  );\n};\n\nexport default ReceiptPeopleTab;\n","import React, { FunctionComponent, useEffect } from 'react';\nimport { Redirect, Route, Switch, useHistory } from 'react-router-dom';\nimport { ReceiptInfoPathProps, ReceiptInfoTabs, Routes } from '../core/BaseRouter';\nimport ReceiptItemsTab from './ReceiptItemsTab';\nimport ReceiptPeopleTab from './ReceiptPeopleTab';\nimport { Box, CircularProgress, Container, Grid, Tab, Tabs, Typography } from '@material-ui/core';\nimport { useParams } from 'react-router';\nimport { updateReceiptValue, useGetReceipt } from '../functions/firebase';\nimport EditableField from '../components/EditableField';\n\nconst ReceiptInfoPage: FunctionComponent = () => {\n  const { receiptId, tab } = useParams<ReceiptInfoPathProps>();\n  const history = useHistory();\n\n  const { receipt, people, isLoading } = useGetReceipt(receiptId);\n\n  useEffect(() => {\n    if (!isLoading && people?.length === 0) {\n      history.push(Routes.receiptInfo.route({ receiptId, tab: 'people' }));\n    }\n  }, [people, isLoading]);\n\n  if (isLoading)\n    return (\n      <Box sx={{ display: 'flex', justifyContent: 'center', mt: 4 }}>\n        <CircularProgress />\n      </Box>\n    );\n\n  return (\n    <>\n      <Container maxWidth={'md'} sx={{ paddingTop: 2 }}>\n        <Grid container spacing={2}>\n          <Grid item xs={12}>\n            <Tabs\n              value={ReceiptInfoTabs.indexOf(tab ?? 'items')}\n              onChange={(event, value) =>\n                history.push(Routes.receiptInfo.route({ receiptId, tab: ReceiptInfoTabs[value] }))\n              }\n              indicatorColor=\"primary\"\n              textColor=\"primary\"\n              centered\n              style={{ marginBottom: 20 }}\n            >\n              {ReceiptInfoTabs.map((tab) => (\n                <Tab key={tab} label={tab} />\n              ))}\n            </Tabs>\n          </Grid>\n          <Grid item xs={12}>\n            <Typography>\n              <EditableField\n                value={receipt?.title ?? ''}\n                onChange={(value) => updateReceiptValue(receiptId, 'title', value)}\n                width={'100%'}\n                textAlign={'left'}\n              />\n            </Typography>\n          </Grid>\n          <Grid item xs={12}>\n            <Switch>\n              <Route path={Routes.receiptInfo.tabPath({ tab: 'items' })} exact component={ReceiptItemsTab} />\n              <Route path={Routes.receiptInfo.tabPath({ tab: 'people' })} exact component={ReceiptPeopleTab} />\n              <Redirect to={Routes.receiptInfo.tabPath({ tab: 'items' })} from={Routes.receiptInfo.path} />\n            </Switch>\n          </Grid>\n        </Grid>\n      </Container>\n    </>\n  );\n};\n\nexport default ReceiptInfoPage;\n","import React, { FunctionComponent } from 'react';\nimport { generatePath, Redirect, Route, Switch } from 'react-router-dom';\nimport { ReceiptsPage } from '../pages/ReceiptsPage';\nimport OldApp from '../pages/old/OldApp';\nimport ReceiptInfoPage from '../pages/ReceiptInfoPage';\n\nconst RECEIPTS_PATH = `/receipts`;\nconst receipts = {\n  path: RECEIPTS_PATH,\n  route: (): string => RECEIPTS_PATH,\n};\n\nexport type ReceiptInfoPathProps = {\n  receiptId: string;\n  tab?: ReceiptInfoTab;\n};\nexport const ReceiptInfoTabs = ['items', 'people'] as const;\nexport type ReceiptInfoTab = typeof ReceiptInfoTabs[number];\nconst RECEIPT_INFO_PATH = `/receipts/:receiptId/:tab?`;\nconst receiptInfo = {\n  path: RECEIPT_INFO_PATH,\n  route: (params: ReceiptInfoPathProps): string => generatePath(RECEIPT_INFO_PATH, params),\n  tabPath: ({ tab }: Required<Pick<ReceiptInfoPathProps, 'tab'>>): string => RECEIPT_INFO_PATH.replace(':tab?', tab),\n};\n\nexport const Routes = {\n  receipts,\n  receiptInfo,\n};\n\nexport const BaseRouter: FunctionComponent = () => {\n  return (\n    <Switch>\n      <Redirect to={Routes.receipts.path} from={'/'} exact />\n      <Route path={Routes.receipts.path} exact component={ReceiptsPage} />\n      <Route path={Routes.receiptInfo.path} exact component={ReceiptInfoPage} />\n      <Route path={'/old'} component={OldApp} />\n    </Switch>\n  );\n};\n","import React, { FunctionComponent } from 'react';\nimport { AppBar, Box, styled, Toolbar, Typography } from '@material-ui/core';\nimport UnstyledLink from '../components/UnstyledLink';\n\nconst Offset = styled('div')(({ theme }) => theme.mixins.toolbar);\n\nconst Layout: FunctionComponent = ({ children }) => {\n  return (\n    <>\n      <Box style={{ paddingBottom: 500 }}>\n        <AppBar position=\"fixed\">\n          <Toolbar>\n            <UnstyledLink to={'/'}>\n              <Typography variant=\"h6\" style={{ flexGrow: 1 }}>\n                Rece\n              </Typography>\n            </UnstyledLink>\n          </Toolbar>\n        </AppBar>\n        <Offset />\n        {children}\n      </Box>\n    </>\n  );\n};\n\nexport default Layout;\n","import { FunctionComponent } from 'react';\nimport { BaseRouter } from './BaseRouter';\nimport Layout from './Layout';\nimport { createTheme, CssBaseline, ThemeProvider } from '@material-ui/core';\nimport { HashRouter as Router } from 'react-router-dom';\nimport { grey } from '@material-ui/core/colors';\n\nconst theme = createTheme({\n  palette: {\n    background: {\n      default: grey[100],\n    },\n  },\n});\n\nconst App: FunctionComponent = () => {\n  return (\n    <Router>\n      <ThemeProvider theme={theme}>\n        <Layout>\n          <CssBaseline />\n          <BaseRouter />\n        </Layout>\n      </ThemeProvider>\n    </Router>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './core/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}
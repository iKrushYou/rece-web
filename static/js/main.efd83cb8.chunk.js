(this["webpackJsonprece-web"]=this["webpackJsonprece-web"]||[]).push([[0],{304:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n.n(c),i=n(62),a=n.n(i),o=n(26),s=n(11),l=n(365),u=n(366),j=n(367),d=n(368),b=n(361),O=n(370),x=n(354),h=n(371),p=n(28),f=n(20),m=n.n(f),v=n(31),g=n(17),y=n(108),C=n(19),w=n.n(C);y.a.initializeApp({apiKey:"AIzaSyA0c1akMZuNjqCKy8XPOJMkt2gCxhbRTDo",authDomain:"rece-a5835.firebaseapp.com",projectId:"rece-a5835",storageBucket:"rece-a5835.appspot.com",messagingSenderId:"952022605285",appId:"1:952022605285:web:dc6c4ad42eaeb6bf1ae30c",measurementId:"G-6Z1RJYKRSE"});y.a.auth;var I=y.a.database().ref().child("receipts"),S=function(e){var t=Object(c.useState)(!0),n=Object(s.a)(t,2),r=n[0],i=n[1],a=Object(c.useState)(),o=Object(s.a)(a,2),l=o[0],u=o[1];Object(c.useEffect)((function(){I.child(e).on("value",(function(t){var n=t.val();u(Object(g.a)(Object(g.a)({},n),{},{id:e})),i(!1)}))}),[]);var j=Object(c.useMemo)((function(){var e;return l?Object.entries(null!==(e=l.items)&&void 0!==e?e:{}).map((function(e){var t=Object(s.a)(e,2),n=t[0],c=t[1];return Object(g.a)(Object(g.a)({},c),{},{id:n})})):[]}),[l]),d=Object(c.useMemo)((function(){return j.reduce((function(e,t){return w()(e).add(t.cost).value}),0)}),[j]),b=Object(c.useMemo)((function(){var e;return l?Object.entries(null!==(e=l.people)&&void 0!==e?e:{}).map((function(e){var t=Object(s.a)(e,2),n=t[0],c=t[1];return Object(g.a)(Object(g.a)({},c),{},{id:n})})):[]}),[l]),O=function(){var t=Object(v.a)(m.a.mark((function t(n,c){var r,i=arguments;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:1,t.next=3,I.child(e).child("personToItemQuantityMap").child(n).child(c).update({quantity:Math.max(r,0)});case 3:return t.next=5,I.child(e).child("itemToPersonQuantityMap").child(c).child(n).update({quantity:Math.max(r,0)});case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),x=Object(c.useMemo)((function(){var e={};if(l){var t,n=Object(p.a)(b);try{for(n.s();!(t=n.n()).done;){var c,r,i=t.value;e[i.id]=Object.entries(null!==(c=null===(r=l.personToItemQuantityMap)||void 0===r?void 0:r[i.id])&&void 0!==c?c:{}).reduce((function(e,t){var n,c,r,i=Object(s.a)(t,2),a=i[0];return e+i[1].quantity*(null!==(n=null===(c=l.items)||void 0===c||null===(r=c[a])||void 0===r?void 0:r.cost)&&void 0!==n?n:0)}),0)}}catch(a){n.e(a)}finally{n.f()}}return e}),[l]),h=Object(c.useMemo)((function(){var e,t;return d+(null!==(e=null===l||void 0===l?void 0:l.tipCost)&&void 0!==e?e:0)+(null!==(t=null===l||void 0===l?void 0:l.taxCost)&&void 0!==t?t:0)}),[d,l]),f=function(e,t){var n;return w()(x[t]).divide(d>0?d:1).multiply(null!==(n=null===l||void 0===l?void 0:l[e])&&void 0!==n?n:0).value};return{isLoading:r,receipt:l,items:j,subTotal:d,total:h,people:b,setPersonItemQuantity:O,personSubTotalMap:x,getChargeForPerson:f,getTotalForPerson:function(e){return w()(x[e]).add(f("taxCost",e)).add(f("tipCost",e)).value}}},T=function(e,t,n){return I.child(e).child(t).set(w()(n).value)},k=function(e,t,n,c){var r=w()(c).multiply(parseFloat(n)).divide(100).value;return I.child(e).child(t).set(w()(r).value)},P=function(e,t,n,c){return I.child(e).child("items").child(t).child(n).set(c)},F=n(355),M=n(167),R=n(70),D=n(1),A=function(e){var t=e.children,n=e.style,c=Object(M.a)(e,["children","style"]);return Object(D.jsx)(R.b,Object(g.a)(Object(g.a)({style:Object(g.a)({color:"inherit",textDecoration:"inherit"},n)},c),{},{children:t}))},q=function(){var e=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)((function(){I.on("value",(function(e){var t=e.val(),n=[];for(var c in t)n.push(Object(g.a)({id:c},t[c]));r(n)}))}),[]),n}();return Object(D.jsxs)(l.a,{maxWidth:"md",sx:{pt:2,display:"flex",flexDirection:"column",gap:2},children:[Object(D.jsx)(u.a,{sx:{mb:2},children:"Receipts"}),Object(D.jsx)(j.a,{sx:{width:"100%"},children:Object(D.jsx)(d.a,{children:e.map((function(e){return Object(D.jsx)(A,{to:He.receiptInfo.route({receiptId:e.id}),children:Object(D.jsx)(b.a,{button:!0,style:{width:"100%"},children:Object(D.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:10},children:[Object(D.jsxs)("div",{style:{display:"flex"},children:[Object(D.jsx)(u.a,{style:{flex:1},children:e.title}),Object(D.jsx)(u.a,{children:w()(e.total).format()})]}),Object(D.jsx)(u.a,{children:Object(F.a)(new Date(e.date),"Pp")})]})})},e.id)}))})}),Object(D.jsx)(z,{})]})},z=function(){var e=Object(c.useState)(""),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(D.jsx)("form",{onSubmit:function(e){var t;(e.preventDefault(),n)&&((t={title:n}).date||(t.date=(new Date).getTime()),t.total||(t.total=0),t.taxCost||(t.taxCost=0),t.tipCost||(t.tipCost=0),t.items||(t.items={}),t.people||(t.people={}),t.personToItemQuantityMap||(t.personToItemQuantityMap={}),t.itemToPersonQuantityMap||(t.itemToPersonQuantityMap={}),I.push(t),r(""))},children:Object(D.jsxs)(O.a,{sx:{display:"flex"},children:[Object(D.jsx)(x.a,{label:"Receipt Name",value:n,fullWidth:!0,variant:"standard",onChange:function(e){return r(e.target.value)},sx:{flex:1}}),Object(D.jsx)(h.a,{type:"submit",children:"Add"})]})})},E=n(357),W=n(382),N=n(6),Q=n(372),B=n(33),K=n(362),V=n(373),J=n(374),L=n(375),G=n(353),Z=n(363),H=n(376),U=n(377),X=n(358),Y=n(30),$=n(359),_=n(16),ee=function(e){return e.toUpperCase().split(" ").map((function(e){return e.substr(0,1)})).join("")},te=function(e){return Object(_.a)(new Set(e))},ne=n(7);var ce=function(e,t){var n=Object(c.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(c){return console.log(c),t}})),r=Object(s.a)(n,2),i=r[0],a=r[1];return[i,function(t){try{var n=t instanceof Function?t(i):t;a(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(c){console.log(c)}}]},re={items:[],people:[],personToItemsMap:{},itemToPeopleMap:{},tip:0,tax:0},ie=function(){},ae=Object(c.createContext)({appData:re,setAppData:ie,reset:ie,putItem:ie,removeItem:ie,splitItem:ie,putPerson:ie,removePerson:ie,handleSetItemPerson:ie,itemCostMap:{},subTotal:0,total:0,subTotalForPerson:function(){return 0},taxForPerson:function(){return 0},tipForPerson:function(){return 0},totalForPerson:function(){return 0}}),oe=function(e){var t=e.children,n=ce("appData",re),r=Object(s.a)(n,2),i=r[0],a=r[1],o=Object(c.useMemo)((function(){return i.items.reduce((function(e,t){return Object(g.a)(Object(g.a)({},e),{},Object(ne.a)({},t.id,t.cost))}),{})}),[i.items]),l=Object(c.useMemo)((function(){return i.items.reduce((function(e,t){return w()(e).add(t.cost).value}),0)}),[i.items]),u=w()(l).add(i.tax).add(i.tip).value,j=function(e){var t;return(null===(t=i.personToItemsMap[e])||void 0===t?void 0:t.reduce((function(e,t){return w()(e).add(w()(o[t]).divide(i.itemToPeopleMap[t].length)).value}),0))||0},d=function(e){return j(e)/l},b=function(e){return w()(i.tax).multiply(d(e)).value},O=function(e){return w()(i.tip).multiply(d(e)).value};return Object(D.jsx)(ae.Provider,{value:{appData:i,setAppData:a,reset:function(){a(re)},putItem:function(e){a((function(t){var n=t.items.map((function(e){return e.id})).indexOf(e.id);return n>-1?(t.items[n]=e,Object(g.a)(Object(g.a)({},t),{},{items:Object(_.a)(t.items)})):Object(g.a)(Object(g.a)({},t),{},{items:[].concat(Object(_.a)(t.items),[e])})}))},removeItem:function(e){a((function(t){return Object(g.a)(Object(g.a)({},t),{},{items:t.items.filter((function(t){return t.id!==e}))})}))},splitItem:function(e){var t=i.items.find((function(t){return t.id===e}));if(t){var n=parseInt(prompt("How many items should (".concat(t.name," - ").concat(w()(t.cost).format(),") be split into?"))||"");if(n&&!isNaN(n)){var c,r=(c=n,new Array(c).fill(0).map((function(e,t){return t}))).map((function(){return{id:Object($.a)(),name:t.name,cost:t.cost/n}}));a((function(t){return Object(g.a)(Object(g.a)({},t),{},{items:[].concat(Object(_.a)(t.items.filter((function(t){return t.id!==e}))),Object(_.a)(r))})}))}}},putPerson:function(e){a((function(t){var n=t.people.map((function(e){return e.id})).indexOf(e.id);return n>-1?(t.people[n]=e,Object(g.a)(Object(g.a)({},t),{},{people:Object(_.a)(t.people)})):Object(g.a)(Object(g.a)({},t),{},{people:[].concat(Object(_.a)(t.people),[e])})}))},removePerson:function(e){a((function(t){return Object(g.a)(Object(g.a)({},t),{},{people:t.people.filter((function(t){return t.id!==e}))})}))},handleSetItemPerson:function(e,t,n){a((function(c){var r,i=c.personToItemsMap,a=c.itemToPeopleMap,o=Object(p.a)(t);try{var s=function(){var t=r.value;i[t]||(i[t]=[]),i[t]=n?te([].concat(Object(_.a)(i[t]),[e])):i[t].filter((function(t){return t!==e})),a[e]||(a[e]=[]),a[e]=n?te([].concat(Object(_.a)(a[e]),[t])):a[e].filter((function(e){return e!==t}))};for(o.s();!(r=o.n()).done;)s()}catch(l){o.e(l)}finally{o.f()}return Object(g.a)(Object(g.a)({},c),{},{personToItemsMap:i,itemToPeopleMap:a})}))},itemCostMap:o,subTotal:l,total:u,subTotalForPerson:j,taxForPerson:b,tipForPerson:O,totalForPerson:function(e){return w()(j(e)).add(b(e)).add(O(e)).value}},children:t})},se=function(){return Object(c.useContext)(ae)},le=n(59),ue=n.n(le),je=n(160),de=n.n(je),be=n(356),Oe=function(e){var t=e.value,n=e.onChange,r=void 0===n?function(){}:n,i=e.formatValue,a=void 0===i?function(e){return"".concat(e)}:i,o=e.type,l=e.disabled,j=void 0!==l&&l,d=e.width,b=void 0===d?80:d,h=e.textAlign,p=void 0===h?"right":h,f=Object(c.useState)(!1),m=Object(s.a)(f,2),v=m[0],g=m[1],y=Object(c.useRef)(),C=Object(B.a)(),w=Object(c.useState)(t),I=Object(s.a)(w,2),S=I[0],T=I[1];Object(c.useEffect)((function(){T(t)}),[t]),Object(c.useLayoutEffect)((function(){var e;v&&(null===(e=y.current)||void 0===e||e.focus())}),[v]);var k={paddingTop:"4px",paddingBottom:"1px",display:"inline-flex",flexDirection:"column",width:b},P=Object(D.jsx)(u.a,{align:p,sx:{width:"100%"},children:a(t)}),F=Object(D.jsx)(O.a,{sx:{marginTop:"2px",height:"1px",width:"100%",backgroundColor:C.palette.text.disabled,opacity:j?0:1}});return v?Object(D.jsx)(x.a,{value:S,onChange:function(e){return T(e.target.value)},type:o,onBlur:function(){return g(!1)},onFocus:function(e){T(t),setTimeout((function(){e.target.setSelectionRange(0,e.target.value.length)}),100)},onKeyDown:function(e){["Enter"].includes(e.code)&&(g(!1),r(S)),["Escape"].includes(e.code)&&g(!1)},inputRef:y,sx:{width:b},variant:"standard",inputProps:{style:{textAlign:p}}}):j?Object(D.jsxs)(O.a,{sx:k,children:[P,F]}):Object(D.jsxs)(be.a,{onClick:function(){return g(!0)},sx:k,children:[P,F]})},xe=n(351),he={name:"",cost:void 0},pe=Object(N.a)(Q.a)((function(){return{backgroundColor:"white","& td":{whiteSpace:"nowrap"}}})),fe=function(){var e=se(),t=e.setAppData,n=e.appData,r=n.items,i=n.people,a=n.personToItemsMap,o=n.itemToPeopleMap,s=n.tax,l=n.tip,j=e.putItem,d=e.removeItem,b=e.splitItem,p=e.handleSetItemPerson,f=e.subTotal,m=e.subTotalForPerson,v=e.total,y=e.taxForPerson,C=e.tipForPerson,I=e.totalForPerson,S=se().reset,T=Object(Y.e)({defaultValues:he}),k=T.control,P=T.handleSubmit,F=T.reset,M=Object(c.useRef)(null),R=Object(c.useRef)(null),A=function(e){var t,n=e.name,c=e.cost,r={id:Object($.a)(),name:n,cost:c};j(r),F(he),null===(t=M.current)||void 0===t||t.focus()},q=function(e){return function(t){var n;"Enter"===t.code&&("name"===e?null===(n=R.current)||void 0===n||n.focus():"cost"===e&&P(A)(t))}},z=Object(B.a)();return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(h.a,{onClick:function(){confirm("Are you sure you'd like to reset?")&&S()},style:{color:"inherit"},children:"Reset"}),Object(D.jsx)(u.a,{children:"Enter Receipt Items"}),Object(D.jsxs)(K.a,{container:!0,spacing:4,children:[Object(D.jsx)(K.a,{item:!0,xs:12,children:Object(D.jsx)("form",{onSubmit:P(A),children:Object(D.jsxs)(K.a,{container:!0,spacing:2,alignItems:"flex-end",children:[Object(D.jsx)(K.a,{item:!0,xs:12,md:6,children:Object(D.jsx)(Y.a,{control:k,name:"name",render:function(e){var t=e.field;return Object(D.jsx)(x.a,Object(g.a)(Object(g.a)({},t),{},{inputRef:function(e){M.current=e,t.ref(e)},label:"Item Name",fullWidth:!0,onKeyDown:q("name")}))}})}),Object(D.jsx)(K.a,{item:!0,xs:12,md:5,children:Object(D.jsx)(Y.a,{control:k,name:"cost",render:function(e){var t=e.field;return Object(D.jsx)(x.a,Object(g.a)(Object(g.a)({},t),{},{inputRef:function(e){R.current=e,t.ref(e)},label:"Cost",fullWidth:!0,onKeyDown:q("cost"),type:"number"}))},rules:{required:!0}})}),Object(D.jsx)(K.a,{item:!0,xs:12,md:1,children:Object(D.jsx)(h.a,{variant:"contained",color:"primary",fullWidth:!0,type:"submit",children:"Add"})})]})})}),Object(D.jsx)(K.a,{item:!0,xs:12,children:Object(D.jsx)(O.a,{style:{overflow:"auto",position:"relative"},children:Object(D.jsxs)(pe,{children:[Object(D.jsx)(V.a,{children:Object(D.jsxs)(J.a,{children:[Object(D.jsx)(L.a,{style:{position:"sticky",left:0,backgroundColor:"white",zIndex:100,minWidth:100},children:"Name"}),Object(D.jsx)(L.a,{style:{minWidth:200},children:"Cost"}),Object(D.jsx)(L.a,{style:{width:1}}),i.map((function(e){return Object(D.jsx)(L.a,{style:{width:1},children:Object(D.jsx)(G.a,{title:e.name,children:Object(D.jsx)(Z.a,{style:{height:24,width:24,fontSize:12},children:ee(e.name)})})},e.id)})),Object(D.jsx)(L.a,{})]})}),Object(D.jsxs)(H.a,{children:[r.map((function(e){var t,n;return Object(D.jsxs)(J.a,{style:{backgroundColor:0===((null===(t=o[e.id])||void 0===t?void 0:t.length)||0)?xe.a[100]:"white"},children:[Object(D.jsx)(L.a,{style:{position:"sticky",left:0,zIndex:100,backgroundColor:0===((null===(n=o[e.id])||void 0===n?void 0:n.length)||0)?xe.a[100]:"white"},children:Object(D.jsx)(Oe,{value:e.name,onChange:function(t){return j(Object(g.a)(Object(g.a)({},e),{},{name:t}))}})}),Object(D.jsx)(L.a,{children:Object(D.jsx)(Oe,{type:"number",value:String(e.cost),onChange:function(t){return j(Object(g.a)(Object(g.a)({},e),{},{cost:parseFloat(t)}))},formatValue:function(e){return w()(e).format()}})}),Object(D.jsx)(L.a,{children:Object(D.jsxs)(O.a,{style:{display:"flex"},children:[Object(D.jsx)(U.a,{size:"small",edge:"end",onClick:function(){return b(e.id)},style:{marginRight:z.spacing(1)},children:Object(D.jsx)(de.a,{color:"primary"})}),Object(D.jsx)(U.a,{size:"small",edge:"end",onClick:function(){confirm("Are you sure you'd like to remove this item?")&&d(e.id)},children:Object(D.jsx)(ue.a,{color:"error"})})]})}),i.map((function(t){var n;return Object(D.jsx)(L.a,{children:Object(D.jsx)(X.a,{checked:(null===(n=a[t.id])||void 0===n?void 0:n.includes(e.id))||!1,onChange:function(n){return p(e.id,[t.id],n.target.checked)}})},t.id)})),Object(D.jsx)(L.a,{style:{width:1},children:Object(D.jsx)(h.a,{onClick:function(){var t;return p(e.id,i.map((function(e){return e.id})),!(null===(t=a[i[0].id])||void 0===t?void 0:t.includes(e.id)))},children:"All"})})]},e.id)})),Object(D.jsxs)(J.a,{children:[Object(D.jsx)(L.a,{style:{position:"sticky",left:0,backgroundColor:"white",zIndex:100,whiteSpace:"nowrap"},children:Object(D.jsx)(u.a,{children:"Subtotal"})}),Object(D.jsx)(L.a,{children:Object(D.jsx)(u.a,{children:w()(f).format()})}),Object(D.jsx)(L.a,{}),i.map((function(e){return Object(D.jsx)(L.a,{children:Object(D.jsx)(u.a,{children:w()(m(e.id)).format()})},e.id)})),Object(D.jsx)(L.a,{})]}),Object(D.jsxs)(J.a,{style:{backgroundColor:0===s?xe.a[100]:void 0},children:[Object(D.jsx)(L.a,{style:{position:"sticky",left:0,zIndex:100,whiteSpace:"nowrap",backgroundColor:0===s?xe.a[100]:"white"},children:Object(D.jsxs)(O.a,{style:{display:"flex",alignItems:"center"},children:[Object(D.jsx)(u.a,{style:{marginRight:10},children:"Tax"}),Object(D.jsx)(Oe,{type:"number",value:String(f>0?s/f:0),onChange:function(e){return t((function(t){return Object(g.a)(Object(g.a)({},t),{},{tax:f*(parseFloat(e)/100)})}))},formatValue:function(e){return"".concat((100*parseFloat(e)).toFixed(2),"%")}})]})}),Object(D.jsx)(L.a,{children:Object(D.jsx)(Oe,{type:"number",value:String(s),onChange:function(e){return t((function(t){return Object(g.a)(Object(g.a)({},t),{},{tax:parseFloat(e)})}))},formatValue:function(e){return w()(e).format()}})}),Object(D.jsx)(L.a,{}),i.map((function(e){return Object(D.jsx)(L.a,{children:Object(D.jsx)(u.a,{children:w()(y(e.id)).format()})},e.id)})),Object(D.jsx)(L.a,{})]}),Object(D.jsxs)(J.a,{style:{backgroundColor:0===l?xe.a[100]:void 0},children:[Object(D.jsx)(L.a,{style:{position:"sticky",left:0,backgroundColor:0===l?xe.a[100]:"white",zIndex:100,whiteSpace:"nowrap"},children:Object(D.jsxs)(O.a,{style:{display:"flex",alignItems:"center"},children:[Object(D.jsx)(u.a,{style:{marginRight:10},children:"Tip"}),Object(D.jsx)(Oe,{type:"number",value:String(f>0?l/f:0),onChange:function(e){return t((function(t){return Object(g.a)(Object(g.a)({},t),{},{tip:f*(parseFloat(e)/100)})}))},formatValue:function(e){return"".concat((100*parseFloat(e)).toFixed(2),"%")}})]})}),Object(D.jsx)(L.a,{children:Object(D.jsx)(Oe,{type:"number",value:String(l),onChange:function(e){return t((function(t){return Object(g.a)(Object(g.a)({},t),{},{tip:parseFloat(e)})}))},formatValue:function(e){return w()(e).format()}})}),Object(D.jsx)(L.a,{}),i.map((function(e){return Object(D.jsx)(L.a,{children:Object(D.jsx)(u.a,{children:w()(C(e.id)).format()})},e.id)})),Object(D.jsx)(L.a,{})]}),Object(D.jsxs)(J.a,{children:[Object(D.jsx)(L.a,{style:{position:"sticky",left:0,backgroundColor:"white",zIndex:100,whiteSpace:"nowrap"},children:Object(D.jsx)(u.a,{children:"Total"})}),Object(D.jsx)(L.a,{style:{paddingTop:0,paddingBottom:0},children:Object(D.jsx)(u.a,{children:w()(v).format()})}),Object(D.jsx)(L.a,{}),i.map((function(e){return Object(D.jsx)(L.a,{style:{paddingTop:0,paddingBottom:0},children:Object(D.jsx)(u.a,{onClick:function(){window.location.href=function(e){var t=e.txn,n=void 0===t?"charge":t,c=e.user,r=void 0===c?"":c,i=e.amount,a=e.note,o=void 0===a?"Split by Rece":a;return"venmo://paycharge?txn=".concat(n,"&recipients=").concat(r,"&amount=").concat(i,"&note=").concat(o)}({amount:I(e.id)})},children:w()(I(e.id)).format()})},e.id)})),Object(D.jsx)(L.a,{})]})]})]})})})]})]})},me=n(378),ve=n(369),ge=function(){var e=se(),t=e.appData.people,n=e.putPerson,r=e.removePerson,i=Object(c.useState)(""),a=Object(s.a)(i,2),o=a[0],l=a[1],j=function(e){e&&(n({id:Object($.a)(),name:e.trim()}),l(""))};return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(u.a,{children:"Enter People"}),Object(D.jsxs)(K.a,{container:!0,spacing:4,children:[Object(D.jsx)(K.a,{item:!0,xs:12,children:Object(D.jsxs)(K.a,{container:!0,spacing:2,alignItems:"flex-end",children:[Object(D.jsx)(K.a,{item:!0,xs:12,md:11,children:Object(D.jsx)(x.a,{value:o,onChange:function(e){return l(e.target.value)},label:"Person Name",fullWidth:!0,onKeyDown:function(e){"Enter"===e.code&&j(o)}})}),Object(D.jsx)(K.a,{item:!0,xs:12,md:1,children:Object(D.jsx)(h.a,{variant:"contained",color:"primary",onClick:function(){return j(o)},fullWidth:!0,children:"Add"})})]})}),Object(D.jsx)(K.a,{item:!0,xs:12,children:Object(D.jsx)(d.a,{children:t.map((function(e){return Object(D.jsxs)(b.a,{children:[Object(D.jsx)(me.a,{children:Object(D.jsx)(Z.a,{children:ee(e.name)})}),Object(D.jsx)(Oe,{value:e.name,onChange:function(t){return n(Object(g.a)(Object(g.a)({},e),{},{name:t}))}}),Object(D.jsx)(ve.a,{children:Object(D.jsx)(U.a,{edge:"end",onClick:function(){return r(e.id)},children:Object(D.jsx)(ue.a,{})})})]},e.id)}))})})]})]})},ye=n(379),Ce=n(380),we=n(381),Ie=function(){var e=Object(c.useState)(!1),t=Object(s.a)(e,2),n=t[0],r=t[1],i=se(),a=i.appData,o=i.subTotalForPerson,j=i.taxForPerson,d=i.tipForPerson,b=i.totalForPerson,x=i.subTotal,p=i.total;return Object(D.jsx)(O.a,{style:{marginBottom:50},children:Object(D.jsx)(l.a,{children:Object(D.jsxs)(ye.a,{children:[Object(D.jsx)(h.a,{onClick:function(){return r((function(e){return!e}))},children:"Debug"}),Object(D.jsx)(Ce.a,{in:n,children:Object(D.jsxs)(we.a,{children:[Object(D.jsx)(Se,{buttonTitle:"appData",children:Object(D.jsx)("pre",{children:JSON.stringify(a,null,2)})}),Object(D.jsxs)(Se,{buttonTitle:"Real Sums",children:[Object(D.jsxs)("div",{children:[Object(D.jsxs)(u.a,{children:["Sub Total (",w()(x).format(),")"]}),a.people.map((function(e){return Object(D.jsxs)("div",{children:[e.name," - ",w()(o(e.id)).format()]},e.id)})),Object(D.jsxs)("div",{children:["Sum -"," ",a.people.reduce((function(e,t){return e.add(o(t.id))}),w()(0)).format()]})]}),Object(D.jsxs)("div",{children:[Object(D.jsxs)(u.a,{children:["Tax (",w()(a.tax).format(),")"]}),a.people.map((function(e){return Object(D.jsxs)("div",{children:[e.name," - ",w()(j(e.id)).format()]},e.id)})),Object(D.jsxs)("div",{children:["Sum -"," ",a.people.reduce((function(e,t){return e.add(j(t.id))}),w()(0)).format()]})]}),Object(D.jsxs)("div",{children:[Object(D.jsxs)(u.a,{children:["Tip (",w()(a.tip).format(),")"]}),a.people.map((function(e){return Object(D.jsxs)("div",{children:[e.name," - ",w()(d(e.id)).format()]},e.id)})),Object(D.jsxs)("div",{children:["Sum -"," ",a.people.reduce((function(e,t){return e.add(d(t.id))}),w()(0)).format()]})]}),Object(D.jsxs)("div",{children:[Object(D.jsxs)(u.a,{children:["Total (",w()(p).format(),")"]}),a.people.map((function(e){return Object(D.jsxs)("div",{children:[e.name," - ",w()(b(e.id)).format()]},e.id)})),Object(D.jsxs)("div",{children:["Sum -"," ",a.people.reduce((function(e,t){return e.add(b(t.id))}),w()(0)).format()]})]})]})]})})]})})})},Se=function(e){var t=e.children,n=e.buttonTitle,r=Object(c.useState)(!1),i=Object(s.a)(r,2),a=i[0],o=i[1];return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(h.a,{onClick:function(){return o((function(e){return!e}))},children:n}),Object(D.jsx)(Ce.a,{in:a,children:t})]})},Te=function(){var e=Object(c.useState)(0),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(D.jsx)("div",{children:Object(D.jsxs)(oe,{children:[Object(D.jsxs)(l.a,{children:[Object(D.jsxs)(E.a,{value:n,onChange:function(e,t){return r(t)},indicatorColor:"primary",textColor:"primary",centered:!0,style:{marginBottom:20},children:[Object(D.jsx)(W.a,{label:"Items"}),Object(D.jsx)(W.a,{label:"People"})]}),0===n&&Object(D.jsx)(fe,{}),1===n&&Object(D.jsx)(ge,{})]}),Object(D.jsx)(Ie,{})]})})},ke=n(383),Pe=n(105),Fe=n(64),Me=n(164),Re=n.n(Me),De=n(165),Ae=n.n(De),qe=Object(N.a)(Q.a)((function(){return{backgroundColor:"white","& td":{whiteSpace:"nowrap",paddingTop:"8px",paddingBottom:"8px"}}})),ze=xe.a[100],Ee=function(){var e=Object(o.i)().receiptId,t=S(e),n=t.receipt,r=t.items,i=t.subTotal,a=t.total,s=t.people,l=t.setPersonItemQuantity,d=t.personSubTotalMap,b=t.getChargeForPerson,x=t.getTotalForPerson,h=Object(c.useCallback)((function(){var t=function(){var e=Object(v.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(confirm("Are you sure you'd like to remove this item?")){e.next=2;break}return e.abrupt("return");case 2:if(n&&t){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,I.child(n.id).child("items").child(t).remove();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return n?Object(D.jsx)(ke.a,{component:j.a,children:Object(D.jsxs)(qe,{children:[Object(D.jsx)(V.a,{children:Object(D.jsxs)(J.a,{children:[Object(D.jsx)(L.a,{}),Object(D.jsx)(L.a,{sx:{width:"1%"},align:"right",children:"Quantity"}),Object(D.jsx)(L.a,{align:"right",sx:{width:"1%"},children:"Cost"}),s.map((function(e){return Object(D.jsx)(L.a,{sx:{width:"1%"},children:Object(D.jsx)(O.a,{sx:{display:"flex",justifyContent:"center"},children:Object(D.jsx)(G.a,{title:e.name,children:Object(D.jsx)(Z.a,{style:{height:24,width:24,fontSize:12},children:ee(e.name)})})})},e.id)})),Object(D.jsx)(L.a,{sx:{width:"1%"}})]})}),Object(D.jsxs)(H.a,{children:[0===r.length?Object(D.jsx)(J.a,{children:Object(D.jsx)(L.a,{align:"center",colSpan:4+s.length,children:"There are no items yet."})}):r.map((function(c){var r=function(e,t){var n,c;return e&&t?Object.values(null!==(n=null===(c=e.itemToPersonQuantityMap)||void 0===c?void 0:c[t])&&void 0!==n?n:{}).reduce((function(e,t){return e+t.quantity}),0):0}(n,c.id)>=c.quantity;return Object(D.jsxs)(J.a,{children:[Object(D.jsx)(L.a,{children:Object(D.jsx)(Oe,{value:c.name,onChange:function(t){return P(e,c.id,"name",t)},textAlign:"left"})}),Object(D.jsx)(L.a,{align:"right",children:Object(D.jsx)(Oe,{value:String(c.quantity),onChange:function(t){return P(e,c.id,"quantity",Math.max(1,parseInt(t)))}})}),Object(D.jsx)(L.a,{align:"right",children:Object(D.jsx)(Oe,{value:w()(c.cost).format(),onChange:function(t){return P(e,c.id,"cost",w()(t).value)}})}),s.map((function(e){var t=function(e,t,n){var c,r,i,a;return e&&t&&n&&null!==(c=null===(r=(null!==(i=(null!==(a=e.personToItemQuantityMap)&&void 0!==a?a:{})[t])&&void 0!==i?i:{})[n])||void 0===r?void 0:r.quantity)&&void 0!==c?c:0}(n,e.id,c.id);return Object(D.jsx)(L.a,{sx:{width:"1%",backgroundColor:r?void 0:ze},align:"center",children:Object(D.jsxs)(O.a,{sx:{display:"inline-flex",justifyContent:"center",alignItems:"center"},children:[Object(D.jsx)(U.a,{size:"small",onClick:function(){return l(e.id,c.id,t-1)},disabled:t<=0,children:Object(D.jsx)(Re.a,{})}),Object(D.jsx)(u.a,{children:JSON.stringify(t)}),Object(D.jsx)(U.a,{size:"small",onClick:function(){return l(e.id,c.id,t+1)},disabled:r,children:Object(D.jsx)(Ae.a,{})})]})},e.id)})),Object(D.jsx)(L.a,{align:"right",children:Object(D.jsx)(U.a,{size:"small",edge:"end",onClick:function(){return t(c.id)},children:Object(D.jsx)(ue.a,{color:"error"})})})]},c.id)})),Object(D.jsx)(J.a,{sx:{height:30,backgroundColor:"background.default"}}),Object(D.jsxs)(J.a,{children:[Object(D.jsx)(L.a,{children:"Sub Total"}),Object(D.jsx)(L.a,{}),Object(D.jsx)(L.a,{align:"right",children:Object(D.jsx)(Oe,{value:w()(i).format(),disabled:!0})}),s.map((function(e){return Object(D.jsx)(L.a,{children:Object(D.jsx)(Oe,{value:w()(d[e.id]).format(),disabled:!0})},e.id)})),Object(D.jsx)(L.a,{})]}),Object(D.jsxs)(J.a,{children:[Object(D.jsx)(L.a,{children:"Tax"}),Object(D.jsx)(L.a,{align:"right",children:Object(D.jsx)(Oe,{value:String((w()(n.taxCost).value/w()(i>0?i:1).value*100).toFixed(3)),formatValue:function(e){return"".concat(e,"%")},onChange:function(t){return k(e,"taxCost",t,i)}})}),Object(D.jsx)(L.a,{align:"right",children:Object(D.jsx)(Oe,{value:w()(n.taxCost).format(),onChange:function(t){return T(e,"taxCost",t)}})}),s.map((function(e){return Object(D.jsx)(L.a,{children:Object(D.jsx)(Oe,{value:w()(b("taxCost",e.id)).format(),disabled:!0})},e.id)})),Object(D.jsx)(L.a,{})]}),Object(D.jsxs)(J.a,{children:[Object(D.jsx)(L.a,{children:"Tip"}),Object(D.jsx)(L.a,{align:"right",children:Object(D.jsx)(Oe,{value:String((w()(n.tipCost).value/w()(i>0?i:1).value*100).toFixed(3)),formatValue:function(e){return"".concat(e,"%")},onChange:function(t){return k(e,"tipCost",t,i)}})}),Object(D.jsx)(L.a,{align:"right",children:Object(D.jsx)(Oe,{value:w()(n.tipCost).format(),onChange:function(t){return T(e,"tipCost",t)}})}),s.map((function(e){return Object(D.jsx)(L.a,{children:Object(D.jsx)(Oe,{value:w()(b("tipCost",e.id)).format(),disabled:!0})},e.id)})),Object(D.jsx)(L.a,{})]}),Object(D.jsxs)(J.a,{children:[Object(D.jsx)(L.a,{}),Object(D.jsx)(L.a,{}),Object(D.jsx)(L.a,{}),s.map((function(e){return Object(D.jsx)(L.a,{children:Object(D.jsx)(O.a,{sx:{display:"flex",justifyContent:"center"},children:Object(D.jsx)(G.a,{title:e.name,children:Object(D.jsx)(Z.a,{style:{height:24,width:24,fontSize:12},children:ee(e.name)})})})},e.id)})),Object(D.jsx)(L.a,{})]}),Object(D.jsxs)(J.a,{children:[Object(D.jsx)(L.a,{children:"Total"}),Object(D.jsx)(L.a,{}),Object(D.jsx)(L.a,{align:"right",children:Object(D.jsx)(Oe,{value:w()(a).format(),disabled:!0})}),s.map((function(e){return Object(D.jsx)(L.a,{children:Object(D.jsx)(Oe,{value:w()(x(e.id)).format(),disabled:!0})},e.id)})),Object(D.jsx)(L.a,{})]})]})]})}):Object(D.jsx)(D.Fragment,{})}),[r]);return Object(D.jsx)(D.Fragment,{children:n&&Object(D.jsxs)(K.a,{container:!0,spacing:2,children:[Object(D.jsx)(K.a,{item:!0,xs:12,children:Object(D.jsx)(Qe,{receipt:n})}),Object(D.jsx)(K.a,{item:!0,xs:12,children:Object(D.jsx)(h,{})})]})})},We={name:"",cost:0,quantity:1},Ne=Fe.b().shape({name:Fe.c().required(),cost:Fe.a().positive().required(),quantity:Fe.a().integer().positive().required()}),Qe=function(e){var t=e.receipt,n=Object(Y.e)({defaultValues:We,resolver:Object(Pe.a)(Ne)}),r=n.control,i=n.handleSubmit,a=n.reset,o=Object(c.useRef)(null),s=Object(c.useRef)(null),l=Object(c.useRef)(null),u=function(){var e=Object(v.a)(m.a.mark((function e(n){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I.child(t.id).child("items").push(n),a(We),null===(c=o.current)||void 0===c||c.focus();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(e){return function(t){var n,c;"Enter"===t.code&&("name"===e&&(null===(n=s.current)||void 0===n?void 0:n.value)?null===(c=s.current)||void 0===c||c.focus():"cost"!==e&&"quantity"!==e||i(u)(t))}},b=function(e){setTimeout((function(){e.target.setSelectionRange(0,e.target.value.length)}),100)};return Object(D.jsx)(j.a,{sx:{p:1},children:Object(D.jsx)("form",{onSubmit:i(u),children:Object(D.jsxs)(K.a,{container:!0,spacing:2,alignItems:"flex-end",children:[Object(D.jsx)(K.a,{item:!0,xs:12,md:6,children:Object(D.jsx)(Y.a,{control:r,name:"name",render:function(e){var t=e.field;return Object(D.jsx)(x.a,Object(g.a)(Object(g.a)({},t),{},{inputRef:function(e){o.current=e,t.ref(e)},variant:"standard",label:"Item Name",fullWidth:!0,onKeyDown:d("name"),onFocus:b}))}})}),Object(D.jsx)(K.a,{item:!0,xs:12,sm:8,md:3,children:Object(D.jsx)(Y.a,{control:r,name:"cost",render:function(e){var t=e.field;return Object(D.jsx)(x.a,Object(g.a)(Object(g.a)({},t),{},{inputRef:function(e){s.current=e,t.ref(e)},variant:"standard",label:"Cost",fullWidth:!0,onKeyDown:d("cost"),onFocus:b,type:"number",inputProps:{step:"any",min:0}}))},rules:{required:!0}})}),Object(D.jsx)(K.a,{item:!0,xs:12,sm:4,md:2,children:Object(D.jsx)(Y.a,{control:r,name:"quantity",render:function(e){var t=e.field;return Object(D.jsx)(x.a,Object(g.a)(Object(g.a)({},t),{},{inputRef:function(e){l.current=e,t.ref(e)},variant:"standard",label:"Quantity",fullWidth:!0,onKeyDown:d("quantity"),onFocus:b,type:"number",inputProps:{min:0}}))},rules:{required:!0}})}),Object(D.jsx)(K.a,{item:!0,xs:12,md:1,children:Object(D.jsx)(h.a,{variant:"contained",color:"primary",fullWidth:!0,type:"submit",children:"Add"})})]})})})},Be=n(384),Ke=function(){var e=Object(o.i)().receiptId,t=S(e),n=t.receipt,r=t.people,i=Object(Y.e)({resolver:Object(Pe.a)(Fe.b().shape({name:Fe.c().required()}))}),a=i.control,s=i.handleSubmit,l=i.reset,p=Object(c.useRef)(null),f=function(e){n&&(I.child(n.id).child("people").push(e),l({name:""}))},y=function(e){"Enter"===e.code&&s(f)(e)},C=function(e){setTimeout((function(){e.target.setSelectionRange(0,e.target.value.length)}),100)},w=function(){var e=Object(v.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(confirm("Are you sure you'd like to remove this person?")){e.next=2;break}return e.abrupt("return");case 2:if(n&&t){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,I.child(n.id).child("people").child(t).remove();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(u.a,{variant:"h3",sx:{mb:2},children:"People"}),Object(D.jsx)(j.a,{children:Object(D.jsxs)(d.a,{children:[r.map((function(e){return Object(D.jsx)(b.a,{children:Object(D.jsxs)(O.a,{sx:{display:"flex",alignItems:"center",width:"100%",gap:2},children:[Object(D.jsx)(me.a,{children:Object(D.jsx)(Z.a,{children:ee(e.name)})}),Object(D.jsx)(Oe,{value:e.name,width:"100%",textAlign:"left"}),Object(D.jsx)(U.a,{size:"small",edge:"end",onClick:function(){return w(e.id)},children:Object(D.jsx)(ue.a,{color:"error"})})]})},e.id)})),(null===r||void 0===r?void 0:r.length)>0&&Object(D.jsx)(Be.a,{sx:{mt:2,mb:2}}),Object(D.jsx)("form",{onSubmit:s(f),children:Object(D.jsx)(b.a,{children:Object(D.jsxs)(O.a,{sx:{width:"100%",display:"flex",gap:"16px"},children:[Object(D.jsx)(Y.a,{control:a,name:"name",render:function(e){var t=e.field;return Object(D.jsx)(x.a,Object(g.a)(Object(g.a)({},t),{},{inputRef:function(e){p.current=e,t.ref(e)},variant:"standard",label:"Person Name",fullWidth:!0,onKeyDown:y,onFocus:C,sx:{flex:1}}))}}),Object(D.jsx)(h.a,{type:"submit",children:"Add"})]})})})]})})]})},Ve=n(385),Je=function(){var e,t=Object(o.i)(),n=t.receiptId,r=t.tab,i=Object(o.h)(),a=S(n),s=a.receipt,j=a.people,d=a.isLoading;return Object(c.useEffect)((function(){d||0!==(null===j||void 0===j?void 0:j.length)||i.push(He.receiptInfo.route({receiptId:n,tab:"people"}))}),[j,d]),d?Object(D.jsx)(O.a,{sx:{display:"flex",justifyContent:"center",mt:4},children:Object(D.jsx)(Ve.a,{})}):Object(D.jsx)(D.Fragment,{children:Object(D.jsx)(l.a,{maxWidth:"md",sx:{paddingTop:2},children:Object(D.jsxs)(K.a,{container:!0,spacing:2,children:[Object(D.jsx)(K.a,{item:!0,xs:12,children:Object(D.jsx)(E.a,{value:Ge.indexOf(null!==r&&void 0!==r?r:"items"),onChange:function(e,t){return i.push(He.receiptInfo.route({receiptId:n,tab:Ge[t]}))},indicatorColor:"primary",textColor:"primary",centered:!0,style:{marginBottom:20},children:Ge.map((function(e){return Object(D.jsx)(W.a,{label:e},e)}))})}),Object(D.jsx)(K.a,{item:!0,xs:12,children:Object(D.jsx)(u.a,{children:Object(D.jsx)(Oe,{value:null!==(e=null===s||void 0===s?void 0:s.title)&&void 0!==e?e:"",onChange:function(e){return function(e,t,n){return I.child(e).child(t).set(n)}(n,"title",e)},width:"100%",textAlign:"left"})})}),Object(D.jsx)(K.a,{item:!0,xs:12,children:Object(D.jsxs)(o.d,{children:[Object(D.jsx)(o.b,{path:He.receiptInfo.tabPath({tab:"items"}),exact:!0,component:Ee}),Object(D.jsx)(o.b,{path:He.receiptInfo.tabPath({tab:"people"}),exact:!0,component:Ke}),Object(D.jsx)(o.a,{to:He.receiptInfo.tabPath({tab:"items"}),from:He.receiptInfo.path})]})})]})})})},Le="/receipts",Ge=["items","people"],Ze="/receipts/:receiptId/:tab?",He={receipts:{path:Le,route:function(){return Le}},receiptInfo:{path:Ze,route:function(e){return Object(o.f)(Ze,e)},tabPath:function(e){var t=e.tab;return Ze.replace(":tab?",t)}}},Ue=function(){return Object(D.jsxs)(o.d,{children:[Object(D.jsx)(o.a,{to:He.receipts.path,from:"/",exact:!0}),Object(D.jsx)(o.b,{path:He.receipts.path,exact:!0,component:q}),Object(D.jsx)(o.b,{path:He.receiptInfo.path,exact:!0,component:Je}),Object(D.jsx)(o.b,{path:"/old",component:Te})]})},Xe=n(386),Ye=n(387),$e=Object(N.a)("div")((function(e){return e.theme.mixins.toolbar})),_e=function(e){var t=e.children;return Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)(O.a,{style:{paddingBottom:500},children:[Object(D.jsx)(Xe.a,{position:"fixed",children:Object(D.jsx)(Ye.a,{children:Object(D.jsx)(A,{to:"/",children:Object(D.jsx)(u.a,{variant:"h6",style:{flexGrow:1},children:"Rece"})})})}),Object(D.jsx)($e,{}),t]})})},et=n(166),tt=n(364),nt=n(352),ct=n(159),rt=Object(et.a)({palette:{background:{default:ct.a[100]}}}),it=function(){return Object(D.jsx)(R.a,{children:Object(D.jsx)(tt.a,{theme:rt,children:Object(D.jsxs)(_e,{children:[Object(D.jsx)(nt.a,{}),Object(D.jsx)(Ue,{})]})})})};a.a.render(Object(D.jsx)(r.a.StrictMode,{children:Object(D.jsx)(it,{})}),document.getElementById("root"))}},[[304,1,2]]]);
//# sourceMappingURL=main.efd83cb8.chunk.js.map